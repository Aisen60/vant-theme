var J=Object.defineProperty,K=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var N=(e,o,a)=>o in e?J(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,x=(e,o)=>{for(var a in o||(o={}))W.call(o,a)&&N(e,a,o[a]);if(V)for(var a of V(o))X.call(o,a)&&N(e,a,o[a]);return e},C=(e,o)=>K(e,Q(o));import{c as $,i as R,G as U,u as ee}from"./use-translate.b8dd01c6.js";import{t as j,b as P,m as w,c as oe,w as S,d as ne,a as _}from"./with-install.b43d27ad.js";import{C as te}from"./index.ded3887f.js";import{z as k,e as n,B as l,D as ae,x as A,E as se,j as ce,v as ue,q as ie,C as L,r as le,o as de,c as re,w as z,A as f}from"./vue-libs.311a0de3.js";import{P as me}from"./index.3f3c7397.js";import{u as pe}from"./use-refs.b90e5fab.js";import{T as he,a as q}from"./index.856b8d55.js";import{F as be}from"./index.4069f783.js";import{B as G}from"./index.2a879481.js";import{C as ge}from"./index.9ffff3d0.js";import{T as fe}from"./function-call.497f808f.js";import"./use-route.fbe6f823.js";import"./index.a6ba9341.js";import"./constant.80c6de18.js";import"./interceptor.14c08b72.js";import"./use-expose.a6a25a51.js";import"./use-touch.41b8a2c4.js";import"./index.e4a9f28d.js";import"./utils.39620306.js";import"./index.2702a97e.js";import"./use-lazy-render.a1d3dbed.js";import"./on-popup-reopen.179515e2.js";import"./index.40018584.js";import"./index.eb7e8095.js";import"./useChildren.9c836bf0.js";import"./useParent.c4a91987.js";import"./index.81d770bd.js";import"./index.886fe652.js";import"./index.a1845386.js";import"./Checker.2c4e4d12.js";import"./mount-component.c1f7730b.js";const[ve,Y,I]=$("coupon-cell"),xe={title:String,border:j,editable:j,coupons:P(),currency:w("\xA5"),chosenCoupon:oe(-1)};function Ce({coupons:e,chosenCoupon:o,currency:a}){const u=e[+o];if(u){let t=0;return R(u.value)?{value:t}=u:R(u.denominations)&&(t=u.denominations),`-${a} ${(t/100).toFixed(2)}`}return e.length===0?I("noCoupon"):I("count",e.length)}var je=k({name:ve,props:xe,setup(e){return()=>{const o=e.coupons[+e.chosenCoupon];return n(te,{class:Y(),value:Ce(e),title:e.title||I("title"),border:e.border,isLink:e.editable,valueClass:Y("value",{selected:o})},null)}}});const we=S(je);function O(e){const o=new Date(e*1e3);return`${o.getFullYear()}.${U(o.getMonth()+1)}.${U(o.getDate())}`}const Be=e=>(e/10).toFixed(e%10==0?0:1),Z=e=>(e/100).toFixed(e%100==0?0:e%10==0?1:2),[ye,d,M]=$("coupon");var De=k({name:ye,props:{chosen:Boolean,coupon:ne(Object),disabled:Boolean,currency:w("\xA5")},setup(e){const o=l(()=>{const{startAt:t,endAt:s}=e.coupon;return`${O(t)} - ${O(s)}`}),a=l(()=>{const{coupon:t,currency:s}=e;if(t.valueDesc)return[t.valueDesc,n("span",null,[t.unitDesc||""])];if(t.denominations){const i=Z(t.denominations);return[n("span",null,[s]),` ${i}`]}return t.discount?M("discount",Be(t.discount)):""}),u=l(()=>{const t=Z(e.coupon.originCondition||0);return t==="0"?M("unlimited"):M("condition",t)});return()=>{const{chosen:t,coupon:s,disabled:i}=e,b=i&&s.reason||s.description;return n("div",{class:d({disabled:i})},[n("div",{class:d("content")},[n("div",{class:d("head")},[n("h2",{class:d("amount")},[a.value]),n("p",{class:d("condition")},[s.condition||u.value])]),n("div",{class:d("body")},[n("p",{class:d("name")},[s.name]),n("p",{class:d("valid")},[o.value]),!i&&n(ge,{class:d("corner"),modelValue:t},null)])]),b&&n("p",{class:d("description")},[b])])}}});const H=S(De),[ke,r,v]=$("coupon-list"),Ee="https://img.yzcdn.cn/vant/coupon-empty.png",Fe={code:w(""),coupons:P(),currency:w("\xA5"),showCount:j,emptyImage:w(Ee),chosenCoupon:_(-1),enabledTitle:String,disabledTitle:String,disabledCoupons:P(),showExchangeBar:j,showCloseButton:j,closeButtonText:String,inputPlaceholder:String,exchangeMinLength:_(1),exchangeButtonText:String,displayedCouponIndex:_(-1),exchangeButtonLoading:Boolean,exchangeButtonDisabled:Boolean};var Te=k({name:ke,props:Fe,emits:["change","exchange","update:code"],setup(e,{emit:o,slots:a}){const[u,t]=pe(),s=ae({tab:0,code:e.code}),i=l(()=>!e.exchangeButtonLoading&&(e.exchangeButtonDisabled||!s.code||s.code.length<e.exchangeMinLength)),b=()=>{o("exchange",s.code),e.code||(s.code="")},B=c=>{ie(()=>{u.value[c]&&u.value[c].scrollIntoView()})},y=()=>n("div",{class:r("empty")},[n("img",{src:e.emptyImage},null),n("p",null,[v("noCoupon")])]),D=()=>{if(e.showExchangeBar)return n("div",{class:r("exchange-bar")},[n(be,{modelValue:s.code,"onUpdate:modelValue":c=>s.code=c,clearable:!0,border:!1,class:r("field"),placeholder:e.inputPlaceholder||v("placeholder"),maxlength:"20"},null),n(G,{plain:!0,type:"danger",class:r("exchange"),text:e.exchangeButtonText||v("exchange"),loading:e.exchangeButtonLoading,disabled:i.value,onClick:b},null)])},E=()=>{const{coupons:c}=e,m=e.showCount?` (${c.length})`:"",p=(e.enabledTitle||v("enable"))+m;return n(q,{title:p},{default:()=>{var g;return[n("div",{class:r("list",{"with-bar":e.showExchangeBar,"with-bottom":e.showCloseButton})},[c.map((h,T)=>n(H,{key:h.id,ref:t(T),coupon:h,chosen:T===e.chosenCoupon,currency:e.currency,onClick:()=>o("change",T)},null)),!c.length&&y(),(g=a["list-footer"])==null?void 0:g.call(a)])]}})},F=()=>{const{disabledCoupons:c}=e,m=e.showCount?` (${c.length})`:"",p=(e.disabledTitle||v("disabled"))+m;return n(q,{title:p},{default:()=>{var g;return[n("div",{class:r("list",{"with-bar":e.showExchangeBar,"with-bottom":e.showCloseButton})},[c.map(h=>n(H,{disabled:!0,key:h.id,coupon:h,currency:e.currency},null)),!c.length&&y(),(g=a["disabled-list-footer"])==null?void 0:g.call(a)])]}})};return A(()=>e.code,c=>{s.code=c}),A(()=>s.code,c=>o("update:code",c)),A(()=>e.displayedCouponIndex,B),se(()=>{B(e.displayedCouponIndex)}),()=>n("div",{class:r()},[D(),n(he,{active:s.tab,"onUpdate:active":c=>s.tab=c,class:r("tab"),border:!1},{default:()=>[E(),F()]}),n("div",{class:r("bottom")},[ce(n(G,{round:!0,block:!0,type:"danger",class:r("close"),text:e.closeButtonText||v("close"),onClick:()=>o("change",-1)},null),[[ue,e.showCloseButton]])])])}});const $e=S(Te),lo=k({setup(e){const o=ee({"zh-CN":{coupon:{name:"\u4F18\u60E0\u5238\u540D\u79F0",reason:"\u4F18\u60E0\u5238\u4E0D\u53EF\u7528\u539F\u56E0",description:"\u63CF\u8FF0\u4FE1\u606F"},exchange:"\u5151\u6362\u6210\u529F"},"en-US":{coupon:{name:"Coupon name",reason:"Coupon unavailable reason",description:"Description"},exchange:"Success"}}),a=(m=999999)=>String(Math.floor(Math.random()*m)+1),u=L(!1),t=L(-1),s=L([]),i=l(()=>({id:1,condition:`\u65E0\u4F7F\u7528\u95E8\u69DB
\u6700\u591A\u4F18\u60E012\u5143`,reason:"",value:150,name:o("coupon.name"),description:o("coupon.description"),startAt:1489104e3,endAt:1514592e3,valueDesc:"1.5",unitDesc:"\u5143"})),b=l(()=>C(x({},i.value),{id:2,value:12,valueDesc:"8.8",unitDesc:"\u6298"})),B=l(()=>C(x({},i.value),{id:3,reason:o("coupon.reason")})),y=l(()=>C(x({},b.value),{valueDesc:"1",unitDesc:"\u6298",id:4,reason:o("coupon.reason")})),D=l(()=>[i.value,b.value,...s.value]),E=l(()=>[B.value,y.value]),F=m=>{u.value=!1,t.value=m},c=()=>{fe(o("exchange")),s.value.push(C(x({},i.value),{id:a()}))};return(m,p)=>{const g=le("demo-block");return de(),re(g,{title:f(o)("basicUsage")},{default:z(()=>[n(f(we),{coupons:f(D),"chosen-coupon":t.value,onClick:p[0]||(p[0]=h=>u.value=!0)},null,8,["coupons","chosen-coupon"]),n(f(me),{show:u.value,"onUpdate:show":p[1]||(p[1]=h=>u.value=h),round:"",position:"bottom",style:{height:"90%","padding-top":"4px"}},{default:z(()=>[n(f($e),{coupons:f(D),"chosen-coupon":t.value,"disabled-coupons":f(E),onChange:F,onExchange:c},null,8,["coupons","chosen-coupon","disabled-coupons"])]),_:1},8,["show"])]),_:1},8,["title"])}}});export{lo as default};
