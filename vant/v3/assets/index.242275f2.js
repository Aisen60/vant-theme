import{c as D,B as E,m as G,h as U,G as q}from"./use-translate.43484c14.js";import{n as B,m as H,c as J,t as K,a as L,w as O}from"./with-install.d47ea1a2.js";import{u as Q}from"./use-refs.29822121.js";import{u as W}from"./use-touch.8e5a0907.js";import{I as T}from"./index.2cac46c1.js";import{z as Y,B as Z,e as d}from"./vue-libs.f710b8ed.js";const[$,f]=D("rate");function x(e,o,s,n){if(e>=o)return{status:"full",value:1};if(e+.5>=o&&s&&!n)return{status:"half",value:.5};if(e+1>=o&&s&&n){const c=10**10;return{status:"half",value:Math.round((e-o+1)*c)/c}}return{status:"void",value:0}}const ee={size:B,icon:H("star"),color:String,count:J(5),gutter:B,readonly:Boolean,disabled:Boolean,voidIcon:H("star-o"),allowHalf:Boolean,voidColor:String,touchable:K,iconPrefix:String,modelValue:L(0),disabledColor:String};var ae=Y({name:$,props:ee,emits:["change","update:modelValue"],setup(e,{emit:o}){const s=W(),[n,c]=Q(),v=()=>e.readonly||e.disabled||!e.touchable,N=Z(()=>Array(+e.count).fill("").map((a,t)=>x(e.modelValue,t+1,e.allowHalf,e.readonly)));let l;const b=()=>{const a=n.value.map(q);l=[],a.forEach((t,r)=>{e.allowHalf?l.push({score:r+.5,left:t.left},{score:r+1,left:t.left+t.width/2}):l.push({score:r+1,left:t.left})})},g=a=>{for(let t=l.length-1;t>0;t--)if(a>l[t].left)return l[t].score;return e.allowHalf?.5:1},y=a=>{!e.disabled&&!e.readonly&&a!==e.modelValue&&(o("update:modelValue",a),o("change",a))},F=a=>{v()||(s.start(a),b())},M=a=>{if(!v()&&(s.move(a),s.isHorizontal())){const{clientX:t}=a.touches[0];G(a),y(g(t))}},X=(a,t)=>{const{icon:r,size:P,color:R,count:w,gutter:S,voidIcon:V,disabled:u,voidColor:C,allowHalf:k,iconPrefix:z,disabledColor:I}=e,m=t+1,h=a.status==="full",i=a.status==="void",_=k&&a.value>0&&a.value<1;let j;S&&m!==+w&&(j={paddingRight:U(S)});const p=A=>{b(),y(k?g(A.clientX):m)};return d("div",{key:t,ref:c(t),role:"radio",style:j,class:f("item"),tabindex:0,"aria-setsize":+w,"aria-posinset":m,"aria-checked":!i,onClick:p},[d(T,{size:P,name:h?r:V,class:f("icon",{disabled:u,full:h}),color:u?I:h?R:C,classPrefix:z},null),_&&d(T,{size:P,style:{width:a.value+"em"},name:i?V:r,class:f("icon",["half",{disabled:u,full:!i}]),color:u?I:i?C:R,classPrefix:z},null)])};return E(()=>e.modelValue),()=>d("div",{role:"radiogroup",class:f({readonly:e.readonly,disabled:e.disabled}),tabindex:0,onTouchstart:F,onTouchmove:M},[N.value.map(X)])}});const ce=O(ae);export{ce as R};
