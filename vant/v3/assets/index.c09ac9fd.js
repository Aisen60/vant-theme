import{u as e,a as i,T as r}from"./index.49dfe0ad.js";import{t,a as o}from"./use-translate.b583725c.js";import{c as s,w as a}from"./with-install.62f47d2f.js";import{i as n}from"./style.21d4b335.js";import{u as l}from"./use-expose.33de0944.js";import{L as d}from"./index.6fa13143.js";import{A as f,E as u,y as m,Y as h,H as p,e as c,s as g,o as v,c as x,w as j,C as b,a as T,b as k,F as y}from"./vendor.ef334a89.js";import{u as C}from"./index.253cf6b3.js";import{u as _}from"./index.7e292110.js";import{u as S}from"./index.90a1ecc4.js";import{C as U}from"./index.550f913c.js";import{P as R}from"./index.465d28bc.js";import"./use-route.3fda2186.js";import"./index.c15090cc.js";import"./event.7d40caae.js";import"./number.b01aa591.js";import"./use-touch.ce80657e.js";import"./on-popup-reopen.522dc00c.js";import"./utils.b0356070.js";import"./useChildren.a94b5b99.js";import"./useParent.0a2f50cb.js";import"./constant.4d85ecb9.js";import"./interceptor.ab1192d4.js";import"./unit.49c29796.js";import"./use-refs.7144ba67.js";import"./index.a7e6e774.js";import"./index.3af24151.js";const[w,I,L]=s("list");const B=a(f({name:w,props:{error:Boolean,loading:Boolean,finished:Boolean,errorText:String,loadingText:String,finishedText:String,immediateCheck:t,offset:{type:[Number,String],default:300},direction:{type:String,default:"down"}},emits:["load","update:error","update:loading"],setup(i,{emit:r,slots:t}){const o=u(!1),s=u(),a=u(),f=e(),v=C(s),x=()=>{g((()=>{if(o.value||i.finished||i.error||!1===(null==f?void 0:f.value))return;const{offset:e,direction:t}=i,l=S(v);if(!l.height||n(s))return;let d=!1;const u=S(a);d="up"===t?l.top-u.top<=e:u.bottom-l.bottom<=e,d&&(o.value=!0,r("update:loading",!0),r("load"))}))},j=()=>{if(i.finished){const e=t.finished?t.finished():i.finishedText;if(e)return c("div",{class:I("finished-text")},[e])}},b=()=>{r("update:error",!1),x()},T=()=>{if(i.error){const e=t.error?t.error():i.errorText;if(e)return c("div",{class:I("error-text"),onClick:b},[e])}},k=()=>{if(o.value&&!i.finished)return c("div",{class:I("loading")},[t.loading?t.loading():c(d,{class:I("loading-icon")},{default:()=>[i.loadingText||L("loading")]})])};return m([()=>i.loading,()=>i.finished,()=>i.error],x),f&&m(f,(e=>{e&&x()})),h((()=>{o.value=i.loading})),p((()=>{i.immediateCheck&&x()})),l({check:x}),_("scroll",x,{target:v}),()=>{var e;const r=null==(e=t.default)?void 0:e.call(t),n=c("div",{ref:a,class:I("placeholder")},null);return c("div",{ref:s,role:"feed",class:I(),"aria-busy":o.value},["down"===i.direction?r:n,k(),j(),T(),"up"===i.direction?r:n])}}}));const P=f({setup(e){const t=o({"zh-CN":{errorInfo:"错误提示",errorText:"请求失败，点击重新加载",pullRefresh:"下拉刷新",finishedText:"没有更多了"},"en-US":{errorInfo:"Error Info",errorText:"Request failed. Click to reload",pullRefresh:"PullRefresh",finishedText:"Finished"}}),s=u([{items:[],refreshing:!1,loading:!1,error:!1,finished:!1},{items:[],refreshing:!1,loading:!1,error:!1,finished:!1},{items:[],refreshing:!1,loading:!1,error:!1,finished:!1}]),a=e=>{const i=s.value[e];i.loading=!0,setTimeout((()=>{i.refreshing&&(i.items=[],i.refreshing=!1);for(let e=0;e<10;e++){const e=i.items.length+1;i.items.push(e<10?"0"+e:String(e))}i.loading=!1,i.refreshing=!1,1!==e||10!==i.items.length||i.error?i.error=!1:i.error=!0,i.items.length>=40&&(i.finished=!0)}),1e3)};return(e,o)=>(v(),x(b(r),null,{default:j((()=>[c(b(i),{title:b(t)("basicUsage")},{default:j((()=>[c(b(B),{loading:s.value[0].loading,"onUpdate:loading":o[0]||(o[0]=e=>s.value[0].loading=e),finished:s.value[0].finished,"finished-text":b(t)("finishedText"),onLoad:o[1]||(o[1]=e=>a(0))},{default:j((()=>[(v(!0),T(y,null,k(s.value[0].items,(e=>(v(),x(b(U),{key:e,title:e},null,8,["title"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["title"]),c(b(i),{title:b(t)("errorInfo")},{default:j((()=>[c(b(B),{loading:s.value[1].loading,"onUpdate:loading":o[2]||(o[2]=e=>s.value[1].loading=e),error:s.value[1].error,"onUpdate:error":o[3]||(o[3]=e=>s.value[1].error=e),finished:s.value[1].finished,"error-text":b(t)("errorText"),onLoad:o[4]||(o[4]=e=>a(1))},{default:j((()=>[(v(!0),T(y,null,k(s.value[1].items,(e=>(v(),x(b(U),{key:e,title:e},null,8,["title"])))),128))])),_:1},8,["loading","error","finished","error-text"])])),_:1},8,["title"]),c(b(i),{title:b(t)("pullRefresh")},{default:j((()=>[c(b(R),{modelValue:s.value[2].refreshing,"onUpdate:modelValue":o[7]||(o[7]=e=>s.value[2].refreshing=e),onRefresh:o[8]||(o[8]=e=>{return i=2,s.value[i].finished=!1,void a(i);var i})},{default:j((()=>[c(b(B),{loading:s.value[2].loading,"onUpdate:loading":o[5]||(o[5]=e=>s.value[2].loading=e),finished:s.value[2].finished,"finished-text":b(t)("finishedText"),onLoad:o[6]||(o[6]=e=>a(2))},{default:j((()=>[(v(!0),T(y,null,k(s.value[2].items,(e=>(v(),x(b(U),{key:e,title:e},null,8,["title"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])])),_:1},8,["title"])])),_:1}))}});export{P as default};
