import{c as D,n as H,m as B,s as E,t as U,p as q,g as x}from"./use-translate.39547e32.js";import{w as G}from"./with-install.cc9696bc.js";import{u as J}from"./use-refs.6c094865.js";import{u as K}from"./use-touch.30351383.js";import{I as T}from"./index.5e447543.js";import{z as L,C as O,e as d}from"./vue-libs.71fdcafc.js";import{u as Q}from"./index.a16d08bc.js";const[W,f]=D("rate");function Y(e,o,l,r){if(e>=o)return{status:"full",value:1};if(e+.5>=o&&l&&!r)return{status:"half",value:.5};if(e+1>=o&&l&&r){const c=10**10;return{status:"half",value:Math.round((e-o+1)*c)/c}}return{status:"void",value:0}}var Z=L({name:W,props:{size:H,icon:B("star"),color:String,count:E(5),gutter:H,readonly:Boolean,disabled:Boolean,voidIcon:B("star-o"),allowHalf:Boolean,voidColor:String,touchable:U,iconPrefix:String,disabledColor:String,modelValue:{type:Number,default:0}},emits:["change","update:modelValue"],setup(e,{emit:o}){const l=K(),[r,c]=J(),g=()=>e.readonly||e.disabled||!e.touchable,N=O(()=>Array(+e.count).fill("").map((t,a)=>Y(e.modelValue,a+1,e.allowHalf,e.readonly)));let s;const b=()=>{const t=r.value.map(a=>a.getBoundingClientRect());s=[],t.forEach((a,n)=>{e.allowHalf?s.push({score:n+.5,left:a.left},{score:n+1,left:a.left+a.width/2}):s.push({score:n+1,left:a.left})})},v=t=>{for(let a=s.length-1;a>0;a--)if(t>s[a].left)return s[a].score;return e.allowHalf?.5:1},y=t=>{!e.disabled&&!e.readonly&&t!==e.modelValue&&(o("update:modelValue",t),o("change",t))},p=t=>{g()||(l.start(t),b())},F=t=>{if(!g()&&(l.move(t),l.isHorizontal())){const{clientX:a}=t.touches[0];q(t),y(v(a))}},M=(t,a)=>{const{icon:n,size:C,color:R,count:w,gutter:P,voidIcon:S,disabled:i,voidColor:V,allowHalf:j,iconPrefix:z,disabledColor:I}=e,m=a+1,h=t.status==="full",u=t.status==="void",X=j&&t.value>0&&t.value<1;let k;P&&m!==+w&&(k={paddingRight:x(P)});const _=A=>{b(),y(j?v(A.clientX):m)};return d("div",{key:a,ref:c(a),role:"radio",style:k,class:f("item"),tabindex:0,"aria-setsize":+w,"aria-posinset":m,"aria-checked":!u,onClick:_},[d(T,{size:C,name:h?n:S,class:f("icon",{disabled:i,full:h}),color:i?I:h?R:V,classPrefix:z},null),X&&d(T,{size:C,style:{width:t.value+"em"},name:u?S:n,class:f("icon",["half",{disabled:i,full:!u}]),color:i?I:u?V:R,classPrefix:z},null)])};return Q(()=>e.modelValue),()=>d("div",{role:"radiogroup",class:f({readonly:e.readonly,disabled:e.disabled}),tabindex:0,onTouchstart:p,onTouchmove:F},[N.value.map(M)])}});const ne=G(Z);export{ne as R};
