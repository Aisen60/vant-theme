import{c as L,f as Y,e as S,v as Z,a as ee}from"./use-translate.5cf29aa7.js";import{n as R,t as U,c as $,b as ae,w as te}from"./with-install.28bb645f.js";import{z as k,C as p,e as s,F as le,G as se,B as j,x as I,j as y,v as E,q as oe,r as ne,o as re,c as ue,w as de,A}from"./vue-libs.cab43f37.js";import{u as ce}from"./use-expose.e3e68c29.js";import{A as ie,a as me}from"./index.47eed87f.js";import{C as N}from"./index.5e7e8759.js";import{F as he}from"./index.7c8c1508.js";import{F as D}from"./index.4087ab90.js";import{P as fe}from"./index.b4723f7e.js";import{T as P}from"./function-call.e4c572a2.js";import{B as z}from"./index.959c7457.js";import{S as ve}from"./index.6bb881f9.js";import"./deep-clone.b25a396d.js";import"./Picker.1164eacc.js";import"./constant.80c6de18.js";import"./index.656b17e0.js";import"./use-touch.0cf4a6e6.js";import"./index.6d4f1bf4.js";import"./use-route.1ad21ca2.js";import"./index.71a5f3d3.js";import"./use-id.af5595af.js";import"./interceptor.e15676cf.js";import"./use-lazy-render.c492e2a8.js";import"./on-popup-reopen.6de6ab9a.js";import"./index.3de7b345.js";import"./mount-component.e414b00a.js";const[be,_,M]=L("address-edit-detail");var Ce=k({name:be,props:{show:Boolean,rows:R,value:String,rules:Array,focused:Boolean,maxlength:R,searchResult:Array,showSearchResult:Boolean},emits:["blur","focus","input","select-search"],setup(e,{emit:l}){const h=p(),c=()=>e.focused&&e.searchResult&&e.showSearchResult,t=n=>{l("select-search",n),l("input",`${n.address||""} ${n.name||""}`.trim())},i=n=>{if(n.name){const d=n.name.replace(e.value,`<span class=${_("keyword")}>${e.value}</span>`);return s("div",{innerHTML:d},null)}},m=()=>{if(!c())return;const{searchResult:n}=e;return n.map(d=>s(N,{clickable:!0,key:d.name+d.address,icon:"location-o",label:d.address,class:_("search-item"),border:!1,onClick:()=>t(d)},{title:()=>i(d)}))},w=n=>l("blur",n),b=n=>l("focus",n),C=n=>l("input",n);return()=>{if(e.show)return s(le,null,[s(D,{autosize:!0,clearable:!0,ref:h,class:_(),rows:e.rows,type:"textarea",rules:e.rules,label:M("label"),border:!c(),maxlength:e.maxlength,modelValue:e.value,placeholder:M("placeholder"),onBlur:w,onFocus:b,"onUpdate:modelValue":C},null),m()])}}});const[ge,v,o]=L("address-edit"),O={name:"",tel:"",city:"",county:"",country:"",province:"",areaCode:"",isDefault:!1,postalCode:"",addressDetail:""},pe=e=>/^\d{6}$/.test(e),De={areaList:Object,isSaving:Boolean,isDeleting:Boolean,validator:Function,showArea:U,showDetail:U,showDelete:Boolean,showPostal:Boolean,disableArea:Boolean,searchResult:Array,telMaxlength:R,showSetDefault:Boolean,saveButtonText:String,areaPlaceholder:String,deleteButtonText:String,showSearchResult:Boolean,detailRows:$(1),detailMaxlength:$(200),areaColumnsPlaceholder:ae(),addressInfo:{type:Object,default:()=>S({},O)},telValidator:{type:Function,default:Z},postalValidator:{type:Function,default:pe}};var we=k({name:ge,props:De,emits:["save","focus","delete","click-area","change-area","change-detail","select-search","change-default"],setup(e,{emit:l,slots:h}){const c=p(),t=se({}),i=p(!1),m=p(!1),w=j(()=>Y(e.areaList)&&Object.keys(e.areaList).length),b=j(()=>{const{country:a,province:r,city:u,county:f,areaCode:B}=t;if(B){const x=[a,r,u,f];return r&&r===u&&x.splice(1,1),x.filter(Boolean).join("/")}return""}),C=j(()=>{var a;return((a=e.searchResult)==null?void 0:a.length)&&m.value}),n=()=>{if(c.value){const a=c.value.getArea();a.areaCode=a.code,delete a.code,S(t,a)}},d=a=>{m.value=a==="addressDetail",l("focus",a)},g=j(()=>{const{validator:a,telValidator:r,postalValidator:u}=e,f=(B,x)=>({validator:V=>{if(a){const T=a(B,V);if(T)return T}return V?!0:x}});return{name:[f("name",o("nameEmpty"))],tel:[f("tel",o("telInvalid")),{validator:r,message:o("telInvalid")}],areaCode:[f("areaCode",o("areaEmpty"))],addressDetail:[f("addressDetail",o("addressEmpty"))],postalCode:[f("addressDetail",o("postalEmpty")),{validator:u,message:o("postalEmpty")}]}}),G=()=>l("save",t),H=a=>{t.addressDetail=a,l("change-detail",a)},q=a=>{a=a.filter(Boolean),a.some(r=>!r.code)?P(o("areaEmpty")):(i.value=!1,n(),l("change-area",a))},J=()=>l("delete",t),K=()=>{var a;return((a=c.value)==null?void 0:a.getValues())||[]},F=a=>{t.areaCode=a||"",a&&oe(n)},Q=()=>{setTimeout(()=>{m.value=!1})},W=a=>{t.addressDetail=a},X=()=>{if(e.showSetDefault){const a={"right-icon":()=>s(ve,{modelValue:t.isDefault,"onUpdate:modelValue":r=>t.isDefault=r,size:"24",onChange:r=>l("change-default",r)},null)};return y(s(N,{center:!0,title:o("defaultAddress"),class:v("default")},a),[[E,!C.value]])}};return ce({getArea:K,setAreaCode:F,setAddressDetail:W}),I(()=>e.areaList,()=>F(t.areaCode)),I(()=>e.addressInfo,a=>{S(t,O,a),F(a.areaCode)},{deep:!0,immediate:!0}),()=>{const{disableArea:a}=e;return s(he,{class:v(),onSubmit:G},{default:()=>{var r;return[s("div",{class:v("fields")},[s(D,{modelValue:t.name,"onUpdate:modelValue":u=>t.name=u,clearable:!0,label:o("name"),rules:g.value.name,placeholder:o("name"),onFocus:()=>d("name")},null),s(D,{modelValue:t.tel,"onUpdate:modelValue":u=>t.tel=u,clearable:!0,type:"tel",label:o("tel"),rules:g.value.tel,maxlength:e.telMaxlength,placeholder:o("tel"),onFocus:()=>d("tel")},null),y(s(D,{readonly:!0,label:o("area"),"is-link":!a,modelValue:b.value,rules:g.value.areaCode,placeholder:e.areaPlaceholder||o("area"),onFocus:()=>d("areaCode"),onClick:()=>{l("click-area"),i.value=!a}},null),[[E,e.showArea]]),s(Ce,{show:e.showDetail,rows:e.detailRows,rules:g.value.addressDetail,value:t.addressDetail,focused:m.value,maxlength:e.detailMaxlength,searchResult:e.searchResult,showSearchResult:e.showSearchResult,onBlur:Q,onFocus:()=>d("addressDetail"),onInput:H,"onSelect-search":u=>l("select-search",u)},null),e.showPostal&&y(s(D,{modelValue:t.postalCode,"onUpdate:modelValue":u=>t.postalCode=u,type:"tel",rules:g.value.postalCode,label:o("postal"),maxlength:"6",placeholder:o("postal"),onFocus:()=>d("postalCode")},null),[[E,!C.value]]),(r=h.default)==null?void 0:r.call(h)]),X(),y(s("div",{class:v("buttons")},[s(z,{block:!0,round:!0,type:"danger",text:e.saveButtonText||o("save"),class:v("button"),loading:e.isSaving,nativeType:"submit"},null),e.showDelete&&s(z,{block:!0,round:!0,class:v("button"),loading:e.isDeleting,text:e.deleteButtonText||o("delete"),onClick:J},null)]),[[E,!C.value]]),s(fe,{show:i.value,"onUpdate:show":u=>i.value=u,round:!0,teleport:"body",position:"bottom",lazyRender:!1},{default:()=>[s(ie,{ref:c,value:t.areaCode,loading:!w.value,areaList:e.areaList,columnsPlaceholder:e.areaColumnsPlaceholder,onConfirm:q,onCancel:()=>{i.value=!1}},null)]})]}})}}});const xe=te(we);const Qe=k({setup(e){const l=ee({"zh-CN":{areaColumnsPlaceholder:["\u8BF7\u9009\u62E9","\u8BF7\u9009\u62E9","\u8BF7\u9009\u62E9"],searchResult:[{name:"\u9EC4\u9F99\u4E07\u79D1\u4E2D\u5FC3",address:"\u676D\u5DDE\u5E02\u897F\u6E56\u533A"},{name:"\u9EC4\u9F99\u4E07\u79D1\u4E2D\u5FC3G\u5EA7"},{name:"\u9EC4\u9F99\u4E07\u79D1\u4E2D\u5FC3H\u5EA7",address:"\u676D\u5DDE\u5E02\u897F\u6E56\u533A"}]},"en-US":{areaColumnsPlaceholder:["Choose","Choose","Choose"],searchResult:[{name:"Name1",address:"Address"},{name:"Name2"},{name:"Name3",address:"Address"}]}}),h=p([]),c=()=>P(l("save")),t=()=>P(l("delete")),i=m=>{h.value=m?l("searchResult"):[]};return(m,w)=>{const b=ne("demo-block");return re(),ue(b,{title:A(l)("basicUsage")},{default:de(()=>[s(A(xe),{"area-list":A(me),"show-postal":"","show-delete":"","show-set-default":"","show-search-result":"","search-result":h.value,"area-columns-placeholder":A(l)("areaColumnsPlaceholder"),onSave:c,onDelete:t,onChangeDetail:i},null,8,["area-list","search-result","area-columns-placeholder"])]),_:1},8,["title"])}}});export{Qe as default};
