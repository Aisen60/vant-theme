import{p as N,c as F,e as G,i as K}from"./use-translate.789845f9.js";import{n as x,t as P,u as M,m as O,w as V}from"./with-install.c13b505f.js";import{N as C,O as Y,x as j,z as H,D as S,C as U,G as $,P as Q,L as Z,e as f,T as q,A as J,Q as W,F as X,j as ee,v as oe,I as te}from"./vue-libs.1dda7261.js";import{c as ne}from"./interceptor.4e67a670.js";import{u as se}from"./use-expose.d54fed8a.js";import{u as ae}from"./use-touch.b0c07ae6.js";import{o as ce,u as re}from"./index.904c4b4d.js";import{g as le}from"./index.0749451f.js";import{u as ie}from"./use-lazy-render.e44d61c0.js";import{P as ue}from"./on-popup-reopen.1b0dc8ad.js";import{I as de}from"./index.83a50000.js";import{O as fe}from"./index.3b26be4c.js";const g={show:Boolean,zIndex:x,overlay:P,duration:x,teleport:[String,Object],lockScroll:P,lazyRender:P,beforeClose:Function,overlayStyle:Object,overlayClass:M,transitionAppear:Boolean,closeOnClickOverlay:P},Le=Object.keys(g);let p=0;const L="van-overflow-hidden";function ve(e,t){const s=ae(),a=r=>{s.move(r);const k=s.deltaY.value>0?"10":"01",h=le(r.target,e.value),{scrollHeight:l,offsetHeight:y,scrollTop:m}=h;let d="11";m===0?d=y>=l?"00":"01":m+y>=l&&(d="10"),d!=="11"&&s.isVertical()&&!(parseInt(d,2)&parseInt(k,2))&&N(r,!0)},n=()=>{document.addEventListener("touchstart",s.start),document.addEventListener("touchmove",a,{passive:!1}),p||document.body.classList.add(L),p++},c=()=>{p&&(document.removeEventListener("touchstart",s.start),document.removeEventListener("touchmove",a),p--,p||document.body.classList.remove(L))},v=()=>t()&&n(),u=()=>t()&&c();ce(v),C(u),Y(u),j(t,r=>{r?n():c()})}function me(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!J(e)}const[pe,z]=F("popup");let A=2e3;var he=H({name:pe,inheritAttrs:!1,props:G({},g,{round:Boolean,position:O("center"),closeIcon:O("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:O("top-right"),safeAreaInsetBottom:Boolean}),emits:["open","close","click","opened","closed","update:show","click-overlay","click-close-icon"],setup(e,{emit:t,attrs:s,slots:a}){let n,c;const v=S(),u=S(),r=ie(()=>e.show||!e.lazyRender),k=U(()=>{const o={zIndex:v.value};if(K(e.duration)){const i=e.position==="center"?"animationDuration":"transitionDuration";o[i]=`${e.duration}s`}return o}),h=()=>{n||(e.zIndex!==void 0&&(A=+e.zIndex),n=!0,v.value=++A,t("open"))},l=()=>{n&&ne({interceptor:e.beforeClose,done(){n=!1,t("close"),t("update:show",!1)}})},y=o=>{t("click-overlay",o),e.closeOnClickOverlay&&l()},m=()=>{if(e.overlay)return f(fe,{show:e.show,class:e.overlayClass,zIndex:v.value,duration:e.duration,customStyle:e.overlayStyle,onClick:y},{default:a["overlay-content"]})},d=o=>{t("click-close-icon",o),l()},B=()=>{if(e.closeable)return f(de,{role:"button",tabindex:0,name:e.closeIcon,class:z("close-icon",e.closeIconPosition),classPrefix:e.iconPrefix,onClick:d},null)},E=o=>t("click",o),D=()=>t("opened"),T=()=>t("closed"),_=r(()=>{var b;const{round:o,position:i,safeAreaInsetBottom:I}=e;return ee(f("div",te({ref:u,style:k.value,class:[z({round:o,[i]:i}),{"van-safe-area-bottom":I}],onClick:E},s),[(b=a.default)==null?void 0:b.call(a),B()]),[[oe,e.show]])}),w=()=>{let o;const{position:i,transition:I,transitionAppear:b}=e,R=i==="center"?"van-fade":`van-popup-slide-${i}`;return f(q,{name:I||R,appear:b,onAfterEnter:D,onAfterLeave:T},me(o=_())?o:{default:()=>[o]})};return j(()=>e.show,o=>{o?h():(n=!1,t("close"))}),se({popupRef:u}),ve(u,()=>e.show&&e.lockScroll),re("popstate",()=>{e.closeOnPopstate&&(l(),c=!1)}),$(()=>{e.show&&h()}),Q(()=>{c&&(t("update:show",!0),c=!1)}),C(()=>{e.show&&(l(),c=!0)}),Z(ue,()=>e.show),()=>e.teleport?f(W,{to:e.teleport},{default:()=>[m(),w()]}):f(X,null,[m(),w()])}});const ze=V(he);export{ze as P,Le as a,g as p};
