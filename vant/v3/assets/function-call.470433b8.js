import{c as e,u as o,i as s,e as t,b as n,d as a}from"./use-translate.91889477.js";import{w as l}from"./with-install.c9eedd0e.js";import{m as i,u as r}from"./mount-component.d3f8f39a.js";import{I as c}from"./index.d38d9435.js";import{P as d}from"./index.b58615a3.js";import{L as u}from"./index.6e9dbec3.js";import{z as p,x as f,G as m,H as y,e as g,I as v,D as h,J as C}from"./vue-libs.71fdcafc.js";let b=0;const[S,k]=e("toast");var w=p({name:S,props:{icon:String,show:Boolean,overlay:Boolean,message:[Number,String],iconSize:[Number,String],className:o,iconPrefix:String,loadingType:String,forbidClick:Boolean,overlayClass:o,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,type:{type:String,default:"text"},duration:{type:Number,default:2e3},position:{type:String,default:"middle"},transition:{type:String,default:"van-fade"}},emits:["update:show"],setup(e,{emit:o}){let t,n=!1;const a=()=>{const o=e.show&&e.forbidClick;n!==o&&(n=o,n?(b||document.body.classList.add("van-toast--unclickable"),b++):b&&(b--,b||document.body.classList.remove("van-toast--unclickable")))},l=e=>o("update:show",e),i=()=>{e.closeOnClick&&l(!1)},r=()=>clearTimeout(t),p=()=>{const{icon:o,type:s,iconSize:t,iconPrefix:n,loadingType:a}=e;return o||"success"===s||"fail"===s?g(c,{name:o||s,size:t,class:k("icon"),classPrefix:n},null):"loading"===s?g(u,{class:k("loading"),size:t,type:a},null):void 0},h=()=>{const{type:o,message:t}=e;if(s(t)&&""!==t)return"html"===o?g("div",{class:k("text"),innerHTML:String(t)},null):g("div",{class:k("text")},[t])};return f((()=>[e.show,e.forbidClick]),a),f((()=>[e.show,e.type,e.message,e.duration]),(()=>{r(),e.show&&e.duration>0&&(t=setTimeout((()=>{l(!1)}),e.duration))})),m(a),y(a),()=>g(d,v({show:e.show,class:[k([e.position,{[e.type]:!e.icon}]),e.className],overlay:e.overlay,lockScroll:!1,transition:e.transition,overlayClass:e.overlayClass,overlayStyle:e.overlayStyle,closeOnClickOverlay:e.closeOnClickOverlay,onClick:i,onClosed:r},{"onUpdate:show":l}),{default:()=>[p(),h()]})}});const O={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let x=[],j=!1,T=t({},O);const z=new Map;function N(e){return a(e)?e:{message:e}}function P(){if(!x.length||j){const e=function(){const{instance:e,unmount:o}=i({setup(){const s=h(""),{open:t,state:n,close:a,toggle:l}=r(),i=()=>{j&&(x=x.filter((o=>o!==e)),o())};return f(s,(e=>{n.message=e})),C().render=()=>g(w,v(n,{onClosed:i,"onUpdate:show":l}),null),{open:t,clear:a,message:s}}});return e}();x.push(e)}return x[x.length-1]}function B(e={}){if(!n)return{};const o=P(),s=N(e);return o.open(t({},T,z.get(s.type||T.type),s)),o}const L=e=>o=>B(t({type:e},N(o)));B.loading=L("loading"),B.success=L("success"),B.fail=L("fail"),B.clear=e=>{var o;x.length&&(e?(x.forEach((e=>{e.clear()})),x=[]):j?null==(o=x.shift())||o.clear():x[0].clear())},B.setDefaultOptions=function(e,o){"string"==typeof e?z.set(e,o):t(T,e)},B.resetDefaultOptions=e=>{"string"==typeof e?z.delete(e):(T=t({},O),z.clear())},B.allowMultiple=(e=!0)=>{j=e},B.install=e=>{e.use(l(w)),e.config.globalProperties.$toast=B};export{B as T};
