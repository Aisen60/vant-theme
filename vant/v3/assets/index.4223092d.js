import{c as _,b as K,e as F,o as Q,u as W}from"./use-translate.a8ac0154.js";import{n as E,t as M,c as k,b as X,w as Y}from"./with-install.6409cc32.js";import{z as B,C as S,e as l,F as Z,D as ee,B as y,x as T,j as D,v as j,q as ae,r as te,o as se,c as oe,w as le,A}from"./vue-libs.4d090e76.js";import{u as re}from"./use-expose.7071738f.js";import{A as ne,a as de}from"./index.81ec118a.js";import{C as L}from"./index.83b0a016.js";import{F as v}from"./index.d4dd83a2.js";import{P as ue}from"./index.f74d82c4.js";import{T as P}from"./function-call.544b7b0b.js";import{B as I}from"./index.1dce146c.js";import{S as ce}from"./index.01fa746c.js";import"./deep-clone.480ea5a4.js";import"./Picker.843ea2e9.js";import"./constant.bdedcaa1.js";import"./index.12b7cbe6.js";import"./use-touch.66e4202e.js";import"./useParent.fa48ddd0.js";import"./useChildren.e93f4c15.js";import"./index.d28b4176.js";import"./use-route.2644a9f9.js";import"./index.fc97feb1.js";import"./index.1f370f94.js";import"./interceptor.92cc09c7.js";import"./index.4a4661ca.js";import"./utils.39620306.js";import"./index.cbbbdc40.js";import"./use-lazy-render.a4eed0b1.js";import"./on-popup-reopen.8d8043ad.js";import"./index.af34d444.js";import"./mount-component.7f7f8bd9.js";const[ie,R,U]=_("address-edit-detail");var he=B({name:ie,props:{show:Boolean,value:String,focused:Boolean,detailRows:E,searchResult:Array,errorMessage:String,detailMaxlength:E,showSearchResult:Boolean},emits:["blur","focus","input","select-search"],setup(a,{emit:o}){const h=S(),c=()=>a.focused&&a.searchResult&&a.showSearchResult,t=n=>{o("select-search",n),o("input",`${n.address||""} ${n.name||""}`.trim())},p=n=>{if(n.name){const i=n.name.replace(a.value,`<span class=${R("keyword")}>${a.value}</span>`);return l("div",{innerHTML:i},null)}},g=()=>{if(!c())return;const{searchResult:n}=a;return n.map(i=>l(L,{clickable:!0,key:i.name+i.address,icon:"location-o",label:i.address,class:R("search-item"),border:!1,onClick:()=>t(i)},{title:()=>p(i)}))},C=n=>o("blur",n),b=n=>o("focus",n),f=n=>o("input",n);return()=>{if(a.show)return l(Z,null,[l(v,{autosize:!0,clearable:!0,ref:h,class:R(),rows:a.detailRows,type:"textarea",label:U("label"),border:!c(),maxlength:a.detailMaxlength,modelValue:a.value,placeholder:U("placeholder"),errorMessage:a.errorMessage,onBlur:C,onFocus:b,"onUpdate:modelValue":f},null),g()])}}});const[me,w,r]=_("address-edit"),$={name:"",tel:"",city:"",county:"",country:"",province:"",areaCode:"",isDefault:!1,postalCode:"",addressDetail:""},fe=a=>/^\d{6}$/.test(a),ge={areaList:Object,isSaving:Boolean,isDeleting:Boolean,validator:Function,showArea:M,showDetail:M,showDelete:Boolean,showPostal:Boolean,disableArea:Boolean,searchResult:Array,telMaxlength:E,showSetDefault:Boolean,saveButtonText:String,areaPlaceholder:String,deleteButtonText:String,showSearchResult:Boolean,detailRows:k(1),detailMaxlength:k(200),areaColumnsPlaceholder:X(),addressInfo:{type:Object,default:()=>F({},$)},telValidator:{type:Function,default:Q},postalValidator:{type:Function,default:fe}};var Ce=B({name:me,props:ge,emits:["save","focus","delete","click-area","change-area","change-detail","select-search","change-default"],setup(a,{emit:o,slots:h}){const c=S(),t=ee({data:{},showAreaPopup:!1,detailFocused:!1,errorInfo:{tel:"",name:"",areaCode:"",postalCode:"",addressDetail:""}}),p=y(()=>K(a.areaList)&&Object.keys(a.areaList).length),g=y(()=>{const{country:e,province:s,city:d,county:m,areaCode:u}=t.data;if(u){const V=[e,s,d,m];return s&&s===d&&V.splice(1,1),V.filter(Boolean).join("/")}return""}),C=y(()=>{var e;return((e=a.searchResult)==null?void 0:e.length)&&t.detailFocused}),b=()=>{if(c.value){const e=c.value.getArea();e.areaCode=e.code,delete e.code,F(t.data,e)}},f=e=>{t.errorInfo[e]="",t.detailFocused=e==="addressDetail",o("focus",e)},n=e=>{const s=String(t.data[e]||"").trim();if(a.validator){const d=a.validator(e,s);if(d)return d}switch(e){case"name":return s?"":r("nameEmpty");case"tel":return a.telValidator(s)?"":r("telInvalid");case"areaCode":return s?"":r("areaEmpty");case"addressDetail":return s?"":r("addressEmpty");case"postalCode":return s&&!a.postalValidator(s)?r("postalEmpty"):""}},i=()=>{const e=["name","tel"];a.showArea&&e.push("areaCode"),a.showDetail&&e.push("addressDetail"),a.showPostal&&e.push("postalCode"),e.every(d=>{const m=n(d);return m&&(t.errorInfo[d]=m),!m})&&!a.isSaving&&o("save",t.data)},N=e=>{t.data.addressDetail=e,o("change-detail",e)},z=e=>{if(e=e.filter(Boolean),e.some(s=>!s.code)){P(r("areaEmpty"));return}t.showAreaPopup=!1,b(),o("change-area",e)},O=()=>o("delete",t.data),H=()=>c.value?c.value.getValues():[],x=e=>{t.data.areaCode=e||"",e&&ae(b)},q=()=>{setTimeout(()=>{t.detailFocused=!1})},G=e=>{t.data.addressDetail=e},J=()=>{if(a.showSetDefault){const e={"right-icon":()=>l(ce,{modelValue:t.data.isDefault,"onUpdate:modelValue":s=>t.data.isDefault=s,size:"24",onChange:s=>o("change-default",s)},null)};return D(l(L,{center:!0,title:r("defaultAddress"),class:w("default")},e),[[j,!C.value]])}return null};return re({getArea:H,setAreaCode:x,setAddressDetail:G}),T(()=>a.areaList,()=>x(t.data.areaCode)),T(()=>a.addressInfo,e=>{t.data=F({},$,e),x(e.areaCode)},{deep:!0,immediate:!0}),()=>{var m;const{data:e,errorInfo:s}=t,{disableArea:d}=a;return l("div",{class:w()},[l("div",{class:w("fields")},[l(v,{modelValue:e.name,"onUpdate:modelValue":u=>e.name=u,clearable:!0,label:r("name"),placeholder:r("name"),errorMessage:s.name,onFocus:()=>f("name")},null),l(v,{modelValue:e.tel,"onUpdate:modelValue":u=>e.tel=u,clearable:!0,type:"tel",label:r("tel"),maxlength:a.telMaxlength,placeholder:r("tel"),errorMessage:s.tel,onFocus:()=>f("tel")},null),D(l(v,{readonly:!0,label:r("area"),"is-link":!d,modelValue:g.value,placeholder:a.areaPlaceholder||r("area"),errorMessage:s.areaCode,onFocus:()=>f("areaCode"),onClick:()=>{o("click-area"),t.showAreaPopup=!d}},null),[[j,a.showArea]]),l(he,{show:a.showDetail,value:e.addressDetail,focused:t.detailFocused,detailRows:a.detailRows,errorMessage:s.addressDetail,searchResult:a.searchResult,detailMaxlength:a.detailMaxlength,showSearchResult:a.showSearchResult,onBlur:q,onFocus:()=>f("addressDetail"),onInput:N,"onSelect-search":u=>o("select-search",u)},null),a.showPostal&&D(l(v,{modelValue:e.postalCode,"onUpdate:modelValue":u=>e.postalCode=u,type:"tel",label:r("postal"),maxlength:"6",placeholder:r("postal"),errorMessage:s.postalCode,onFocus:()=>f("postalCode")},null),[[j,!C.value]]),(m=h.default)==null?void 0:m.call(h)]),J(),D(l("div",{class:w("buttons")},[l(I,{block:!0,round:!0,type:"danger",text:a.saveButtonText||r("save"),class:w("button"),loading:a.isSaving,onClick:i},null),a.showDelete&&l(I,{block:!0,round:!0,class:w("button"),loading:a.isDeleting,text:a.deleteButtonText||r("delete"),onClick:O},null)]),[[j,!C.value]]),l(ue,{show:t.showAreaPopup,"onUpdate:show":u=>t.showAreaPopup=u,round:!0,teleport:"body",position:"bottom",lazyRender:!1},{default:()=>[l(ne,{ref:c,value:e.areaCode,loading:!p.value,areaList:a.areaList,columnsPlaceholder:a.areaColumnsPlaceholder,onConfirm:z,onCancel:()=>{t.showAreaPopup=!1}},null)]})])}}});const be=Y(Ce);const Ke=B({setup(a){const o=W({"zh-CN":{areaColumnsPlaceholder:["\u8BF7\u9009\u62E9","\u8BF7\u9009\u62E9","\u8BF7\u9009\u62E9"],searchResult:[{name:"\u9EC4\u9F99\u4E07\u79D1\u4E2D\u5FC3",address:"\u676D\u5DDE\u5E02\u897F\u6E56\u533A"},{name:"\u9EC4\u9F99\u4E07\u79D1\u4E2D\u5FC3G\u5EA7"},{name:"\u9EC4\u9F99\u4E07\u79D1\u4E2D\u5FC3H\u5EA7",address:"\u676D\u5DDE\u5E02\u897F\u6E56\u533A"}]},"en-US":{areaColumnsPlaceholder:["Choose","Choose","Choose"],searchResult:[{name:"Name1",address:"Address"},{name:"Name2"},{name:"Name3",address:"Address"}]}}),h=S([]),c=()=>P(o("save")),t=()=>P(o("delete")),p=g=>{h.value=g?o("searchResult"):[]};return(g,C)=>{const b=te("demo-block");return se(),oe(b,{title:A(o)("basicUsage")},{default:le(()=>[l(A(be),{"area-list":A(de),"show-postal":"","show-delete":"","show-set-default":"","show-search-result":"","search-result":h.value,"area-columns-placeholder":A(o)("areaColumnsPlaceholder"),onSave:c,onDelete:t,onChangeDetail:p},null,8,["area-list","search-result","area-columns-placeholder"])]),_:1},8,["title"])}}});export{Ke as default};
