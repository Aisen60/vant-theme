import{t as e,i as t,p as r,e as a,u as n}from"./use-translate.b583725c.js";import{b as l,a as o,c as i,s,d as c,e as d,f as u,w as p}from"./with-install.62f47d2f.js";import{A as f,D as v,e as b,B as m,E as g,y,H as h,G as S,s as x,Q as j,J as w,N as C,M as I,l as B,v as k}from"./vendor.ef334a89.js";import{a as N,r as T}from"./use-route.3fda2186.js";import{S as R,u as z,a as A}from"./index.c15090cc.js";import{u as $}from"./useParent.0a2f50cb.js";import{d as L}from"./constant.4d85ecb9.js";import{i as O}from"./style.21d4b335.js";import{c as W}from"./interceptor.ab1192d4.js";import{u as Z,a as M}from"./unit.49c29796.js";import{r as q}from"./utils.b0356070.js";import{u as F}from"./use-refs.7144ba67.js";import{u as H}from"./use-expose.33de0944.js";import{o as D}from"./on-popup-reopen.522dc00c.js";import{S as V}from"./index.a7e6e774.js";import{B as X}from"./index.3af24151.js";import{u as E}from"./index.253cf6b3.js";import{u as G}from"./useChildren.a94b5b99.js";import{o as J,u as P}from"./index.7e292110.js";const[Q,K]=i("tab");var U=f({name:Q,props:{dot:Boolean,type:String,color:String,title:String,badge:[Number,String],isActive:Boolean,disabled:Boolean,scrollable:Boolean,activeColor:String,renderTitle:Function,inactiveColor:String,showZeroBadge:e},setup(e){const r=v((()=>{const t={},{type:r,color:a,disabled:n,isActive:l,activeColor:o,inactiveColor:i}=e;a&&"card"===r&&(t.borderColor=a,n||(l?t.backgroundColor=a:t.color=a));const s=l?o:i;return s&&(t.color=s),t})),a=()=>{const r=b("span",{class:K("text",{ellipsis:!e.scrollable})},[e.renderTitle?e.renderTitle():e.title]);return e.dot||t(e.badge)&&""!==e.badge?b(X,{dot:e.dot,content:e.badge,showZero:e.showZeroBadge},"function"==typeof(a=r)||"[object Object]"===Object.prototype.toString.call(a)&&!m(a)?r:{default:()=>[r]}):r;var a};return()=>b("div",{role:"tab",class:[K({active:e.isActive,disabled:e.disabled})],style:r.value,"aria-selected":e.isActive},[a()])}});const[Y,_]=i("tabs");var ee=f({name:Y,props:{inited:Boolean,animated:Boolean,swipeable:Boolean,lazyRender:Boolean,count:{type:Number,required:!0},duration:{type:[Number,String],required:!0},currentIndex:{type:Number,required:!0}},emits:["change"],setup(e,{emit:t,slots:r}){const a=g(),n=e=>t("change",e),l=()=>{var t;const l=null==(t=r.default)?void 0:t.call(r);return e.animated||e.swipeable?b(R,{ref:a,loop:!1,class:_("track"),duration:1e3*+e.duration,touchable:e.swipeable,lazyRender:e.lazyRender,showIndicators:!1,onChange:n},"function"==typeof(o=l)||"[object Object]"===Object.prototype.toString.call(o)&&!m(o)?l:{default:()=>[l]}):l;var o},o=t=>{const r=a.value;r&&r.state.active!==t&&r.swipeTo(t,{immediate:!e.inited})};return y((()=>e.currentIndex),o),h((()=>{o(e.currentIndex)})),()=>b("div",{class:_("content",{animated:e.animated||e.swipeable})},[l()])}});const[te,re]=i("tabs"),ae={color:String,border:Boolean,sticky:Boolean,animated:Boolean,ellipsis:e,swipeable:Boolean,scrollspy:Boolean,background:String,lazyRender:e,lineWidth:[Number,String],lineHeight:[Number,String],beforeChange:Function,titleActiveColor:String,titleInactiveColor:String,type:{type:String,default:"line"},active:{type:[Number,String],default:0},duration:{type:[Number,String],default:.3},offsetTop:{type:[Number,String],default:0},swipeThreshold:{type:[Number,String],default:5}},ne=Symbol(te);var le=f({name:te,props:ae,emits:["click","change","scroll","disabled","rendered","click-tab","update:active"],setup(e,{emit:a,slots:n}){let i,p,f;const m=g(),h=g(),C=g(),I=z(),B=E(m),[k,T]=F(),{children:R,linkChildren:A}=G(ne),$=S({inited:!1,position:"",lineStyle:{},currentIndex:-1}),X=v((()=>R.length>e.swipeThreshold||!e.ellipsis)),Q=v((()=>({borderColor:e.color,background:e.background}))),K=(e,t)=>{var r;return null!=(r=e.name)?r:t},Y=v((()=>{const e=R[$.currentIndex];if(e)return K(e,$.currentIndex)})),_=v((()=>Z(e.offsetTop))),te=v((()=>e.sticky?_.value+i:0)),ae=t=>{const r=h.value,a=k.value;if(!(X.value&&r&&a&&a[$.currentIndex]))return;const n=a[$.currentIndex].$el;!function(e,t,r){let a=0;const n=e.scrollLeft,l=0===r?1:Math.round(1e3*r/16);!function r(){e.scrollLeft+=(t-n)/l,++a<l&&q(r)}()}(r,n.offsetLeft-(r.offsetWidth-n.offsetWidth)/2,t?0:+e.duration)},le=()=>{const r=$.inited;x((()=>{const a=k.value;if(!a||!a[$.currentIndex]||"line"!==e.type||O(m.value))return;const n=a[$.currentIndex].$el,{lineWidth:l,lineHeight:o}=e,i=n.offsetLeft+n.offsetWidth/2,s={width:M(l),backgroundColor:e.color,transform:`translateX(${i}px) translateX(-50%)`};if(r&&(s.transitionDuration=`${e.duration}s`),t(o)){const e=M(o);s.height=e,s.borderRadius=e}$.lineStyle=s}))},oe=r=>{const n=(e=>{const t=e<$.currentIndex?-1:1;for(;e>=0&&e<R.length;){if(!R[e].disabled)return e;e+=t}})(r);if(!t(n))return;const l=R[n],o=K(l,n),i=null!==$.currentIndex;$.currentIndex=n,o!==e.active&&(a("update:active",o),i&&a("change",o,l.title))},ie=e=>{const t=R.find(((t,r)=>K(t,r)===e)),r=t?R.indexOf(t):0;oe(r)},se=(t=!1)=>{if(e.scrollspy){const r=R[$.currentIndex].$el;if(r&&B.value){const a=c(r,B.value)-te.value;p=!0,function(e,t,r,a){let n=l(e);const i=n<t,s=0===r?1:Math.round(1e3*r/16),c=(t-n)/s;!function r(){n+=c,(i&&n>t||!i&&n<t)&&(n=t),o(e,n),i&&n<t||!i&&n>t?q(r):a&&q(a)}()}(B.value,a,t?0:+e.duration,(()=>{p=!1}))}}},ce=e=>{f=e.isFixed,a("scroll",e)},de=()=>R.map(((t,n)=>b(U,w({ref:T(n),type:e.type,color:e.color,style:t.titleStyle,class:t.titleClass,isActive:n===$.currentIndex,scrollable:X.value,renderTitle:t.$slots.title,activeColor:e.titleActiveColor,inactiveColor:e.titleInactiveColor,onClick:r=>{((t,r,n)=>{const{title:l,disabled:o}=R[r],i=K(R[r],r);a("click-tab",{name:i,title:l,event:n,disabled:o}),o?a("disabled",i,l):(W({interceptor:e.beforeChange,args:[i],done:()=>{oe(r),se()}}),a("click",i,l),N(t))})(t,n,r)}},r(t,["dot","badge","title","disabled","showZeroBadge"])),null))),ue=()=>{var t,r;const{type:a,border:l}=e;return b("div",{ref:C,class:[re("wrap",{scrollable:X.value}),{[L]:"line"===a&&l}]},[b("div",{ref:h,role:"tablist",class:re("nav",[a,{complete:X.value}]),style:Q.value},[null==(t=n["nav-left"])?void 0:t.call(n),de(),"line"===a&&b("div",{class:re("line"),style:$.lineStyle},null),null==(r=n["nav-right"])?void 0:r.call(n)])])};y([()=>e.color,I.width],le),y((()=>e.active),(e=>{e!==Y.value&&ie(e)})),y((()=>R.length),(()=>{$.inited&&(ie(e.active),le(),x((()=>{ae(!0)})))})),y((()=>$.currentIndex),(()=>{ae(),le(),f&&!e.scrollspy&&s(Math.ceil(c(m.value)-_.value))}));return H({resize:le,scrollTo:e=>{x((()=>{ie(e),se(!0)}))}}),j(le),D(le),J((()=>{ie(e.active),x((()=>{$.inited=!0,i=d(C.value),ae(!0)}))})),P("scroll",(()=>{if(e.scrollspy&&!p){const e=(()=>{for(let e=0;e<R.length;e++)if(u(R[e].$el)>te.value)return 0===e?0:e-1;return R.length-1})();oe(e)}}),{target:B}),A({props:e,setLine:le,onRendered:(e,t)=>a("rendered",e,t),currentName:Y,scrollIntoView:ae}),()=>{var t;return b("div",{ref:m,class:re([e.type])},[e.sticky?b(V,{container:m.value,offsetTop:_.value,onScroll:ce},{default:()=>{var e;return[ue(),null==(e=n["nav-bottom"])?void 0:e.call(n)]}}):[ue(),null==(t=n["nav-bottom"])?void 0:t.call(n)],b(ee,{count:R.length,inited:$.inited,animated:e.animated,duration:e.duration,swipeable:e.swipeable,lazyRender:e.lazyRender,currentIndex:$.currentIndex,onChange:oe},{default:()=>{var e;return[null==(e=n.default)?void 0:e.call(n)]}})])}}});const oe=Symbol(),ie=()=>C(oe,null),[se,ce]=i("tab");const de=p(f({name:se,props:a({},T,{dot:Boolean,name:[Number,String],badge:[Number,String],title:String,disabled:Boolean,titleClass:n,titleStyle:[String,Object],showZeroBadge:e}),setup(e,{slots:t}){const r=g(!1),{parent:a,index:n}=$(ne);if(!a)return;const l=()=>{var t;return null!=(t=e.name)?t:n.value},o=v((()=>{const t=l()===a.currentName.value;return t&&!r.value&&(r.value=!0,a.props.lazyRender&&x((()=>{a.onRendered(l(),e.title)}))),t}));return y((()=>e.title),(()=>{a.setLine(),a.scrollIntoView()})),I(oe,o),()=>{var e;const{animated:n,swipeable:l,scrollspy:i,lazyRender:s}=a.props;if(!t.default&&!n)return;const c=i||o.value;if(n||l)return b(A,{role:"tabpanel","aria-hidden":!o.value,class:ce("pane-wrapper",{inactive:!o.value})},{default:()=>{var e;return[b("div",{class:ce("pane")},[null==(e=t.default)?void 0:e.call(t)])]}});const d=r.value||i||!s?null==(e=t.default)?void 0:e.call(t):null;return B(b("div",{role:"tabpanel",class:ce("pane")},[d]),[[k,c]])}}})),ue=p(le);export{ue as T,de as a,ie as u};
