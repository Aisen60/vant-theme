import{c as _,n as F,d as K,e as E,t as M,s as k,v as Q,a as W}from"./use-translate.39547e32.js";import{w as X}from"./with-install.cc9696bc.js";import{z as B,D as y,e as l,I as Y,F as Z,E as ee,C as S,x as T,k as v,v as j,q as ae,r as te,o as se,c as oe,w as le,B as x}from"./vue-libs.71fdcafc.js";import{u as re}from"./use-expose.877c018b.js";import{A as ne,a as de}from"./index.c67e98e9.js";import{C as I}from"./index.f7946dd6.js";import{F as p}from"./index.1bfd2dc9.js";import{P as ue}from"./index.760aa272.js";import{T as P}from"./function-call.025b6196.js";import{B as L}from"./index.64adedce.js";import{D as ce}from"./function-call.be59c9c4.js";import{S as ie}from"./index.c0ecfe94.js";import"./deep-clone.c68588c0.js";import"./Picker.8ba0489b.js";import"./constant.4d85ecb9.js";import"./index.b9a228ca.js";import"./use-touch.30351383.js";import"./useParent.e4fd6deb.js";import"./useChildren.edf9a3d1.js";import"./index.afbc7dff.js";import"./use-route.913efdd2.js";import"./index.5e447543.js";import"./index.a16d08bc.js";import"./interceptor.33314343.js";import"./index.92de2fdc.js";import"./utils.39620306.js";import"./index.c1e8d10d.js";import"./use-lazy-render.3dcfda58.js";import"./on-popup-reopen.d7054786.js";import"./index.0ff7945f.js";import"./mount-component.a2b5841e.js";import"./index.975c4ad5.js";const[he,R,U]=_("address-edit-detail");var me=B({name:he,props:{show:Boolean,value:String,focused:Boolean,detailRows:F,searchResult:Array,errorMessage:String,detailMaxlength:F,showSearchResult:Boolean},emits:["blur","focus","input","select-search"],setup(a,{emit:o}){const h=y(),c=()=>a.focused&&a.searchResult&&a.showSearchResult,t=n=>{o("select-search",n),o("input",`${n.address||""} ${n.name||""}`.trim())},b=n=>{if(n.name){const i=n.name.replace(a.value,`<span class=${R("keyword")}>${a.value}</span>`);return l("div",{innerHTML:i},null)}},g=()=>{if(!c())return;const{searchResult:n}=a;return n.map(i=>l(I,{clickable:!0,key:i.name+i.address,icon:"location-o",label:i.address,class:R("search-item"),border:!1,onClick:()=>t(i)},{title:()=>b(i)}))},C=n=>o("blur",n),w=n=>o("focus",n),f=n=>o("input",n);return()=>{if(a.show)return l(Z,null,[l(p,Y({autosize:!0,clearable:!0,ref:h,class:R(),rows:a.detailRows,type:"textarea",label:U("label"),border:!c(),maxlength:a.detailMaxlength,modelValue:a.value,placeholder:U("placeholder"),errorMessage:a.errorMessage,onBlur:C,onFocus:w},{"onUpdate:modelValue":f}),null),g()])}}});const[fe,D,r]=_("address-edit"),$={name:"",tel:"",city:"",county:"",country:"",province:"",areaCode:"",isDefault:!1,postalCode:"",addressDetail:""},ge=a=>/^\d{6}$/.test(a),Ce={areaList:Object,isSaving:Boolean,isDeleting:Boolean,validator:Function,showArea:M,showDetail:M,showDelete:Boolean,showPostal:Boolean,disableArea:Boolean,searchResult:Array,telMaxlength:F,showSetDefault:Boolean,saveButtonText:String,areaPlaceholder:String,deleteButtonText:String,showSearchResult:Boolean,detailRows:k(1),detailMaxlength:k(200),addressInfo:{type:Object,default:()=>E({},$)},telValidator:{type:Function,default:Q},postalValidator:{type:Function,default:ge},areaColumnsPlaceholder:{type:Array,default:()=>[]}};var we=B({name:fe,props:Ce,emits:["save","focus","delete","click-area","change-area","change-detail","cancel-delete","select-search","change-default"],setup(a,{emit:o,slots:h}){const c=y(),t=ee({data:{},showAreaPopup:!1,detailFocused:!1,errorInfo:{tel:"",name:"",areaCode:"",postalCode:"",addressDetail:""}}),b=S(()=>K(a.areaList)&&Object.keys(a.areaList).length),g=S(()=>{const{country:e,province:s,city:d,county:m,areaCode:u}=t.data;if(u){const V=[e,s,d,m];return s&&s===d&&V.splice(1,1),V.filter(Boolean).join("/")}return""}),C=S(()=>{var e;return((e=a.searchResult)==null?void 0:e.length)&&t.detailFocused}),w=()=>{if(c.value){const e=c.value.getArea();e.areaCode=e.code,delete e.code,E(t.data,e)}},f=e=>{t.errorInfo[e]="",t.detailFocused=e==="addressDetail",o("focus",e)},n=e=>{const s=String(t.data[e]||"").trim();if(a.validator){const d=a.validator(e,s);if(d)return d}switch(e){case"name":return s?"":r("nameEmpty");case"tel":return a.telValidator(s)?"":r("telInvalid");case"areaCode":return s?"":r("areaEmpty");case"addressDetail":return s?"":r("addressEmpty");case"postalCode":return s&&!a.postalValidator(s)?r("postalEmpty"):""}},i=()=>{const e=["name","tel"];a.showArea&&e.push("areaCode"),a.showDetail&&e.push("addressDetail"),a.showPostal&&e.push("postalCode"),e.every(d=>{const m=n(d);return m&&(t.errorInfo[d]=m),!m})&&!a.isSaving&&o("save",t.data)},N=e=>{t.data.addressDetail=e,o("change-detail",e)},z=e=>{if(e=e.filter(Boolean),e.some(s=>!s.code)){P(r("areaEmpty"));return}t.showAreaPopup=!1,w(),o("change-area",e)},O=()=>{ce.confirm({title:r("confirmDelete")}).then(()=>o("delete",t.data)).catch(()=>o("cancel-delete",t.data))},H=()=>c.value?c.value.getValues():[],A=e=>{t.data.areaCode=e||"",e&&ae(w)},q=()=>{setTimeout(()=>{t.detailFocused=!1})},G=e=>{t.data.addressDetail=e},J=()=>{if(a.showSetDefault){const e={"right-icon":()=>l(ie,{modelValue:t.data.isDefault,"onUpdate:modelValue":s=>t.data.isDefault=s,size:"24",onChange:s=>o("change-default",s)},null)};return v(l(I,{center:!0,title:r("defaultAddress"),class:D("default")},e),[[j,!C.value]])}return null};return re({getArea:H,setAreaCode:A,setAddressDetail:G}),T(()=>a.areaList,()=>A(t.data.areaCode)),T(()=>a.addressInfo,e=>{t.data=E({},$,e),A(e.areaCode)},{deep:!0,immediate:!0}),()=>{var m;const{data:e,errorInfo:s}=t,{disableArea:d}=a;return l("div",{class:D()},[l("div",{class:D("fields")},[l(p,{modelValue:e.name,"onUpdate:modelValue":u=>e.name=u,clearable:!0,label:r("name"),placeholder:r("name"),errorMessage:s.name,onFocus:()=>f("name")},null),l(p,{modelValue:e.tel,"onUpdate:modelValue":u=>e.tel=u,clearable:!0,type:"tel",label:r("tel"),maxlength:a.telMaxlength,placeholder:r("tel"),errorMessage:s.tel,onFocus:()=>f("tel")},null),v(l(p,{readonly:!0,label:r("area"),"is-link":!d,modelValue:g.value,placeholder:a.areaPlaceholder||r("area"),errorMessage:s.areaCode,onFocus:()=>f("areaCode"),onClick:()=>{o("click-area"),t.showAreaPopup=!d}},null),[[j,a.showArea]]),l(me,{show:a.showDetail,value:e.addressDetail,focused:t.detailFocused,detailRows:a.detailRows,errorMessage:s.addressDetail,searchResult:a.searchResult,detailMaxlength:a.detailMaxlength,showSearchResult:a.showSearchResult,onBlur:q,onFocus:()=>f("addressDetail"),onInput:N,"onSelect-search":u=>o("select-search",u)},null),a.showPostal&&v(l(p,{modelValue:e.postalCode,"onUpdate:modelValue":u=>e.postalCode=u,type:"tel",label:r("postal"),maxlength:"6",placeholder:r("postal"),errorMessage:s.postalCode,onFocus:()=>f("postalCode")},null),[[j,!C.value]]),(m=h.default)==null?void 0:m.call(h)]),J(),v(l("div",{class:D("buttons")},[l(L,{block:!0,round:!0,type:"danger",text:a.saveButtonText||r("save"),class:D("button"),loading:a.isSaving,onClick:i},null),a.showDelete&&l(L,{block:!0,round:!0,class:D("button"),loading:a.isDeleting,text:a.deleteButtonText||r("delete"),onClick:O},null)]),[[j,!C.value]]),l(ue,{show:t.showAreaPopup,"onUpdate:show":u=>t.showAreaPopup=u,round:!0,teleport:"body",position:"bottom",lazyRender:!1},{default:()=>[l(ne,{ref:c,value:e.areaCode,loading:!b.value,areaList:a.areaList,columnsPlaceholder:a.areaColumnsPlaceholder,onConfirm:z,onCancel:()=>{t.showAreaPopup=!1}},null)]})])}}});const De=X(we);const Xe=B({setup(a){const o=W({"zh-CN":{areaColumnsPlaceholder:["\u8BF7\u9009\u62E9","\u8BF7\u9009\u62E9","\u8BF7\u9009\u62E9"],searchResult:[{name:"\u9EC4\u9F99\u4E07\u79D1\u4E2D\u5FC3",address:"\u676D\u5DDE\u5E02\u897F\u6E56\u533A"},{name:"\u9EC4\u9F99\u4E07\u79D1\u4E2D\u5FC3G\u5EA7"},{name:"\u9EC4\u9F99\u4E07\u79D1\u4E2D\u5FC3H\u5EA7",address:"\u676D\u5DDE\u5E02\u897F\u6E56\u533A"}]},"en-US":{areaColumnsPlaceholder:["Choose","Choose","Choose"],searchResult:[{name:"Name1",address:"Address"},{name:"Name2"},{name:"Name3",address:"Address"}]}}),h=y([]),c=()=>P(o("save")),t=()=>P(o("delete")),b=g=>{h.value=g?o("searchResult"):[]};return(g,C)=>{const w=te("demo-block");return se(),oe(w,{title:x(o)("basicUsage")},{default:le(()=>[l(x(De),{"area-list":x(de),"show-postal":"","show-delete":"","show-set-default":"","show-search-result":"","search-result":h.value,"area-columns-placeholder":x(o)("areaColumnsPlaceholder"),onSave:c,onDelete:t,onChangeDetail:b},null,8,["area-list","search-result","area-columns-placeholder"])]),_:1},8,["title"])}}});export{Xe as default};
