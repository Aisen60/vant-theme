import{c as r,t as o,i as a,g as e,b as i}from"./use-translate.91889477.js";import{w as s}from"./with-install.c9eedd0e.js";import{I as l}from"./index.d38d9435.js";import{z as n,D as t,J as d,C as u,x as c,O as g,e as f,k as m,U as v,I as h}from"./vue-libs.71fdcafc.js";const[p,S]=r("image");const w=s(n({name:p,props:{src:String,alt:String,fit:String,round:Boolean,width:[Number,String],height:[Number,String],radius:[Number,String],lazyLoad:Boolean,iconSize:[Number,String],showError:o,iconPrefix:String,showLoading:o,errorIcon:{type:String,default:"photo-fail"},loadingIcon:{type:String,default:"photo"}},emits:["load","error"],setup(r,{emit:o,slots:s}){const n=t(!1),p=t(!0),w=t(),{$Lazyload:z}=d().proxy,x=u((()=>{const o={};return a(r.width)&&(o.width=e(r.width)),a(r.height)&&(o.height=e(r.height)),a(r.radius)&&(o.overflow="hidden",o.borderRadius=e(r.radius)),o}));c((()=>r.src),(()=>{n.value=!1,p.value=!0}));const y=r=>{p.value=!1,o("load",r)},b=r=>{n.value=!0,p.value=!1,o("error",r)},I=()=>{if(n.value||!r.src)return;const o={alt:r.alt,class:S("img"),style:{objectFit:r.fit}};return r.lazyLoad?m(f("img",h({ref:w},o),null),[[v("lazy"),r.src]]):f("img",h({src:r.src,onLoad:y,onError:b},o),null)},L=({el:r})=>{r===w.value&&p.value&&y()},j=({el:r})=>{r!==w.value||n.value||b()};return z&&i&&(z.$on("loaded",L),z.$on("error",j),g((()=>{z.$off("loaded",L),z.$off("error",j)}))),()=>{var o;return f("div",{class:S({round:r.round}),style:x.value},[I(),p.value&&r.showLoading?f("div",{class:S("loading")},[s.loading?s.loading():f(l,{size:r.iconSize,name:r.loadingIcon,class:S("loading-icon"),classPrefix:r.iconPrefix},null)]):n.value&&r.showError?f("div",{class:S("error")},[s.error?s.error():f(l,{size:r.iconSize,name:r.errorIcon,class:S("error-icon"),classPrefix:r.iconPrefix},null)]):void 0,null==(o=s.default)?void 0:o.call(s)])}}}));export{w as I};
