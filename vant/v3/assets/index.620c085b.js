import{t as r,i as o,b as a}from"./use-translate.b583725c.js";import{c as e,w as i}from"./with-install.62f47d2f.js";import{a as s}from"./unit.49c29796.js";import{I as l}from"./index.3af24151.js";import{A as n,E as t,L as d,D as u,y as c,P as f,e as g,l as m,V as v,J as h}from"./vendor.ef334a89.js";const[p,S]=e("image");const w=i(n({name:p,props:{src:String,alt:String,fit:String,round:Boolean,width:[Number,String],height:[Number,String],radius:[Number,String],lazyLoad:Boolean,iconSize:[Number,String],showError:r,iconPrefix:String,showLoading:r,errorIcon:{type:String,default:"photo-fail"},loadingIcon:{type:String,default:"photo"}},emits:["load","error"],setup(r,{emit:e,slots:i}){const n=t(!1),p=t(!0),w=t(),{$Lazyload:y}=d().proxy,z=u((()=>{const a={};return o(r.width)&&(a.width=s(r.width)),o(r.height)&&(a.height=s(r.height)),o(r.radius)&&(a.overflow="hidden",a.borderRadius=s(r.radius)),a}));c((()=>r.src),(()=>{n.value=!1,p.value=!0}));const b=r=>{p.value=!1,e("load",r)},x=r=>{n.value=!0,p.value=!1,e("error",r)},L=()=>{if(n.value||!r.src)return;const o={alt:r.alt,class:S("img"),style:{objectFit:r.fit}};return r.lazyLoad?m(g("img",h({ref:w},o),null),[[v("lazy"),r.src]]):g("img",h({src:r.src,onLoad:b,onError:x},o),null)},j=({el:r})=>{r===w.value&&p.value&&b()},I=({el:r})=>{r!==w.value||n.value||x()};return y&&a&&(y.$on("loaded",j),y.$on("error",I),f((()=>{y.$off("loaded",j),y.$off("error",I)}))),()=>{var o;return g("div",{class:S({round:r.round}),style:z.value},[L(),p.value&&r.showLoading?g("div",{class:S("loading")},[i.loading?i.loading():g(l,{size:r.iconSize,name:r.loadingIcon,class:S("loading-icon"),classPrefix:r.iconPrefix},null)]):n.value&&r.showError?g("div",{class:S("error")},[i.error?i.error():g(l,{size:r.iconSize,name:r.errorIcon,class:S("error-icon"),classPrefix:r.iconPrefix},null)]):void 0,null==(o=i.default)?void 0:o.call(i)])}}}));export{w as I};
