import{c as U,f as j,j as J,t as D,i as F,F as Q,v as X,h as Y}from"./use-translate.33b17133.js";import{c,t as r,n as f,w as Z}from"./with-install.d00852e2.js";import{z as p,C as _,B as h,x as V,e as b,j as I,v as x,H as z,q as ee}from"./vue-libs.7d3cdfcb.js";import{H as R}from"./constant.80c6de18.js";import{c as te}from"./interceptor.926f5054.js";import{u as ne}from"./index.02ce6e6d.js";const[ae,g]=U("stepper"),le=200,se=600,v=(t,i)=>String(t)===String(i),ie={min:c(1),max:c(1/0),name:c(""),step:c(1),theme:String,integer:Boolean,disabled:Boolean,showPlus:r,showMinus:r,showInput:r,longPress:r,allowEmpty:Boolean,modelValue:f,inputWidth:f,buttonSize:f,placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,defaultValue:c(1),decimalLength:f};var ue=p({name:ae,props:ie,emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(t,{emit:i}){const o=e=>{const{min:n,max:s,allowEmpty:m,decimalLength:l}=t;return m&&e===""||(e=D(String(e),!t.integer),e=e===""?0:+e,e=Number.isNaN(e)?+n:e,e=Math.max(Math.min(+s,e),+n),F(l)&&(e=e.toFixed(+l))),e},k=()=>{var s;const e=(s=t.modelValue)!=null?s:t.defaultValue,n=o(e);return v(n,t.modelValue)||i("update:modelValue",n),n};let u;const y=_(),a=_(k()),S=h(()=>t.disabled||t.disableMinus||a.value<=+t.min),w=h(()=>t.disabled||t.disablePlus||a.value>=+t.max),A=h(()=>({width:j(t.inputWidth),height:j(t.buttonSize)})),N=h(()=>J(t.buttonSize)),H=()=>{const e=o(a.value);v(e,a.value)||(a.value=e)},C=e=>{t.beforeChange?te(t.beforeChange,{args:[e],done(){a.value=e}}):a.value=e},P=()=>{if(u==="plus"&&w.value||u==="minus"&&S.value){i("overlimit",u);return}const e=u==="minus"?-t.step:+t.step,n=o(Q(+a.value,e));C(n),i(u)},q=e=>{const n=e.target,{value:s}=n,{decimalLength:m}=t;let l=D(String(s),!t.integer);if(F(m)&&l.includes(".")){const M=l.split(".");l=`${M[0]}.${M[1].slice(0,+m)}`}t.beforeChange?n.value=String(a.value):v(s,l)||(n.value=l);const K=l===String(+l);C(K?+l:l)},G=e=>{var n;t.disableInput?(n=y.value)==null||n.blur():i("focus",e)},O=e=>{const n=e.target,s=o(n.value);n.value=String(s),a.value=s,ee(()=>{i("blur",e),X()})};let T,d;const B=()=>{d=setTimeout(()=>{P(),B()},le)},W=()=>{t.longPress&&(T=!1,clearTimeout(d),d=setTimeout(()=>{T=!0,P(),B()},se))},E=e=>{t.longPress&&(clearTimeout(d),T&&Y(e))},$=e=>{t.disableInput&&e.preventDefault()},L=e=>({onClick:n=>{n.preventDefault(),u=e,P()},onTouchstart:()=>{u=e,W()},onTouchend:E,onTouchcancel:E});return V([()=>t.max,()=>t.min,()=>t.integer,()=>t.decimalLength],H),V(()=>t.modelValue,e=>{v(e,a.value)||(a.value=o(e))}),V(a,e=>{i("update:modelValue",e),i("change",e,{name:t.name})}),ne(()=>t.modelValue),()=>b("div",{class:g([t.theme])},[I(b("button",z({type:"button",style:N.value,class:[g("minus",{disabled:S.value}),{[R]:!S.value}]},L("minus")),null),[[x,t.showMinus]]),I(b("input",{ref:y,type:t.integer?"tel":"text",role:"spinbutton",class:g("input"),value:a.value,style:A.value,disabled:t.disabled,readonly:t.disableInput,inputmode:t.integer?"numeric":"decimal",placeholder:t.placeholder,"aria-valuemax":+t.max,"aria-valuemin":+t.min,"aria-valuenow":+a.value,onBlur:O,onInput:q,onFocus:G,onMousedown:$},null),[[x,t.showInput]]),I(b("button",z({type:"button",style:N.value,class:[g("plus",{disabled:w.value}),{[R]:!w.value}]},L("plus")),null),[[x,t.showPlus]])])}});const he=Z(ue);export{he as S};
