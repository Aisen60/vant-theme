import{u as e,i as o,e as s,b as t,c as a}from"./use-translate.b583725c.js";import{c as n,w as l}from"./with-install.62f47d2f.js";import{m as i,u as r}from"./mount-component.4a14b4e1.js";import{I as c}from"./index.3af24151.js";import{P as d}from"./index.aa2914ba.js";import{L as u}from"./index.6fa13143.js";import{A as p,y as f,H as m,I as y,e as g,J as v,E as h,L as C}from"./vendor.ef334a89.js";let b=0;const[S,k]=n("toast");var w=p({name:S,props:{icon:String,show:Boolean,overlay:Boolean,message:[Number,String],iconSize:[Number,String],className:e,iconPrefix:String,loadingType:String,forbidClick:Boolean,overlayClass:e,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,type:{type:String,default:"text"},duration:{type:Number,default:2e3},position:{type:String,default:"middle"},transition:{type:String,default:"van-fade"}},emits:["update:show"],setup(e,{emit:s}){let t,a=!1;const n=()=>{const o=e.show&&e.forbidClick;a!==o&&(a=o,a?(b||document.body.classList.add("van-toast--unclickable"),b++):b&&(b--,b||document.body.classList.remove("van-toast--unclickable")))},l=e=>s("update:show",e),i=()=>{e.closeOnClick&&l(!1)},r=()=>clearTimeout(t),p=()=>{const{icon:o,type:s,iconSize:t,iconPrefix:a,loadingType:n}=e;return o||"success"===s||"fail"===s?g(c,{name:o||s,size:t,class:k("icon"),classPrefix:a},null):"loading"===s?g(u,{class:k("loading"),size:t,type:n},null):void 0},h=()=>{const{type:s,message:t}=e;if(o(t)&&""!==t)return"html"===s?g("div",{class:k("text"),innerHTML:String(t)},null):g("div",{class:k("text")},[t])};return f((()=>[e.show,e.forbidClick]),n),f((()=>[e.show,e.type,e.message,e.duration]),(()=>{r(),e.show&&e.duration>0&&(t=setTimeout((()=>{l(!1)}),e.duration))})),m(n),y(n),()=>g(d,v({show:e.show,class:[k([e.position,{[e.type]:!e.icon}]),e.className],overlay:e.overlay,lockScroll:!1,transition:e.transition,overlayClass:e.overlayClass,overlayStyle:e.overlayStyle,closeOnClickOverlay:e.closeOnClickOverlay,onClick:i,onClosed:r},{"onUpdate:show":l}),{default:()=>[p(),h()]})}});const O={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let x=[],j=!1,T=s({},O);const N=new Map;function P(e){return a(e)?e:{message:e}}function z(){if(!x.length||j){const e=function(){const{instance:e,unmount:o}=i({setup(){const s=h(""),{open:t,state:a,close:n,toggle:l}=r(),i=()=>{j&&(x=x.filter((o=>o!==e)),o())};return f(s,(e=>{a.message=e})),C().render=()=>g(w,v(a,{onClosed:i,"onUpdate:show":l}),null),{open:t,clear:n,message:s}}});return e}();x.push(e)}return x[x.length-1]}function B(e={}){if(!t)return{};const o=z(),a=P(e);return o.open(s({},T,N.get(a.type||T.type),a)),o}const L=e=>o=>B(s({type:e},P(o)));B.loading=L("loading"),B.success=L("success"),B.fail=L("fail"),B.clear=e=>{var o;x.length&&(e?(x.forEach((e=>{e.clear()})),x=[]):j?null==(o=x.shift())||o.clear():x[0].clear())},B.setDefaultOptions=function(e,o){"string"==typeof e?N.set(e,o):s(T,e)},B.resetDefaultOptions=e=>{"string"==typeof e?N.delete(e):(T=s({},O),N.clear())},B.allowMultiple=(e=!0)=>{j=e},B.install=e=>{e.use(l(w)),e.config.globalProperties.$toast=B};export{B as T};
