import{c as B,i as d,h as u,d as E}from"./use-translate.43484c14.js";import{n as c,t as L,m as z,w as $}from"./with-install.d47ea1a2.js";import{I as C}from"./index.2cac46c1.js";import{z as D,C as f,O as U,B as N,x as R,I as k,e as a,j as F,U as O,Q as P}from"./vue-libs.f710b8ed.js";const[Q,o]=B("image"),V={src:String,alt:String,fit:String,round:Boolean,width:c,height:c,radius:c,lazyLoad:Boolean,iconSize:c,showError:L,errorIcon:z("photo-fail"),iconPrefix:String,showLoading:L,loadingIcon:z("photo")};var _=D({name:Q,props:V,emits:["load","error"],setup(r,{emit:g,slots:n}){const i=f(!1),t=f(!0),l=f(),{$Lazyload:s}=U().proxy,x=N(()=>{const e={};return d(r.width)&&(e.width=u(r.width)),d(r.height)&&(e.height=u(r.height)),d(r.radius)&&(e.overflow="hidden",e.borderRadius=u(r.radius)),e});R(()=>r.src,()=>{i.value=!1,t.value=!0});const m=e=>{t.value=!1,g("load",e)},h=e=>{i.value=!0,t.value=!1,g("error",e)},v=(e,b,y)=>y?y():a(C,{name:e,size:r.iconSize,class:b,classPrefix:r.iconPrefix},null),S=()=>{if(t.value&&r.showLoading)return a("div",{class:o("loading")},[v(r.loadingIcon,o("loading-icon"),n.loading)]);if(i.value&&r.showError)return a("div",{class:o("error")},[v(r.errorIcon,o("error-icon"),n.error)])},j=()=>{if(i.value||!r.src)return;const e={alt:r.alt,class:o("img"),style:{objectFit:r.fit}};return r.lazyLoad?F(a("img",P({ref:l},e),null),[[O("lazy"),r.src]]):a("img",P({src:r.src,onLoad:m,onError:h},e),null)},w=({el:e})=>{e===l.value&&t.value&&m()},I=({el:e})=>{e===l.value&&!i.value&&h()};return s&&E&&(s.$on("loaded",w),s.$on("error",I),k(()=>{s.$off("loaded",w),s.$off("error",I)})),()=>{var e;return a("div",{class:o({round:r.round}),style:x.value},[j(),S(),(e=n.default)==null?void 0:e.call(n)])}}});const J=$(_);export{J as I};
