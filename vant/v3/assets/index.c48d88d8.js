import{c as D,p as E,f as U,z as q}from"./use-translate.dc7c72f2.js";import{n as H,m as T,b as x,t as G,a as J,w as K}from"./with-install.eb95b9ca.js";import{u as L}from"./use-refs.af7a4653.js";import{u as O}from"./use-touch.89cea093.js";import{I as B}from"./index.c4602e68.js";import{z as Q,C as W,e as f}from"./vue-libs.84090ae0.js";import{u as Y}from"./index.e89b0366.js";const[Z,d]=D("rate");function $(e,o,s,n){if(e>=o)return{status:"full",value:1};if(e+.5>=o&&s&&!n)return{status:"half",value:.5};if(e+1>=o&&s&&n){const c=10**10;return{status:"half",value:Math.round((e-o+1)*c)/c}}return{status:"void",value:0}}var ee=Q({name:Z,props:{size:H,icon:T("star"),color:String,count:x(5),gutter:H,readonly:Boolean,disabled:Boolean,voidIcon:T("star-o"),allowHalf:Boolean,voidColor:String,touchable:G,iconPrefix:String,modelValue:J(0),disabledColor:String},emits:["change","update:modelValue"],setup(e,{emit:o}){const s=O(),[n,c]=L(),b=()=>e.readonly||e.disabled||!e.touchable,N=W(()=>Array(+e.count).fill("").map((a,t)=>$(e.modelValue,t+1,e.allowHalf,e.readonly)));let l;const v=()=>{const a=n.value.map(q);l=[],a.forEach((t,r)=>{e.allowHalf?l.push({score:r+.5,left:t.left},{score:r+1,left:t.left+t.width/2}):l.push({score:r+1,left:t.left})})},g=a=>{for(let t=l.length-1;t>0;t--)if(a>l[t].left)return l[t].score;return e.allowHalf?.5:1},y=a=>{!e.disabled&&!e.readonly&&a!==e.modelValue&&(o("update:modelValue",a),o("change",a))},p=a=>{b()||(s.start(a),v())},F=a=>{if(!b()&&(s.move(a),s.isHorizontal())){const{clientX:t}=a.touches[0];E(a),y(g(t))}},M=(a,t)=>{const{icon:r,size:P,color:R,count:w,gutter:C,voidIcon:S,disabled:i,voidColor:V,allowHalf:z,iconPrefix:j,disabledColor:k}=e,m=t+1,h=a.status==="full",u=a.status==="void",X=z&&a.value>0&&a.value<1;let I;C&&m!==+w&&(I={paddingRight:U(C)});const _=A=>{v(),y(z?g(A.clientX):m)};return f("div",{key:t,ref:c(t),role:"radio",style:I,class:d("item"),tabindex:0,"aria-setsize":+w,"aria-posinset":m,"aria-checked":!u,onClick:_},[f(B,{size:P,name:h?r:S,class:d("icon",{disabled:i,full:h}),color:i?k:h?R:V,classPrefix:j},null),X&&f(B,{size:P,style:{width:a.value+"em"},name:u?S:r,class:d("icon",["half",{disabled:i,full:!u}]),color:i?k:u?V:R,classPrefix:j},null)])};return Y(()=>e.modelValue),()=>f("div",{role:"radiogroup",class:d({readonly:e.readonly,disabled:e.disabled}),tabindex:0,onTouchstart:p,onTouchmove:F},[N.value.map(M)])}});const ce=K(ee);export{ce as R};
