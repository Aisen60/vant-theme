import{u as e,a as i,T as r}from"./index.c005411f.js";import{c as t,t as o,E as s,a as n}from"./use-translate.91889477.js";import{w as a}from"./with-install.c9eedd0e.js";import{u as l}from"./use-expose.5ea79906.js";import{L as d}from"./index.6e9dbec3.js";import{z as f,D as u,x as h,X as m,G as p,e as g,q as c,o as v,c as x,w as j,B as T,a as b,b as k,F as _}from"./vue-libs.71fdcafc.js";import{u as C}from"./index.9e2e36ca.js";import{u as S}from"./index.94f7437a.js";import{u as U}from"./index.43faf238.js";import{C as y}from"./index.5d323f2c.js";import{P as R}from"./index.e0c465d6.js";import"./use-route.913efdd2.js";import"./index.0a6905cd.js";import"./use-touch.30351383.js";import"./on-popup-reopen.d7054786.js";import"./utils.b0356070.js";import"./useChildren.edf9a3d1.js";import"./useParent.e4fd6deb.js";import"./constant.4d85ecb9.js";import"./interceptor.fd551ac3.js";import"./use-refs.6c094865.js";import"./index.2b3be213.js";import"./index.d38d9435.js";const[w,B,I]=t("list");const L=a(f({name:w,props:{error:Boolean,loading:Boolean,finished:Boolean,errorText:String,loadingText:String,finishedText:String,immediateCheck:o,offset:{type:[Number,String],default:300},direction:{type:String,default:"down"}},emits:["load","update:error","update:loading"],setup(i,{emit:r,slots:t}){const o=u(!1),n=u(),a=u(),f=e(),v=C(n),x=()=>{c((()=>{if(o.value||i.finished||i.error||!1===(null==f?void 0:f.value))return;const{offset:e,direction:t}=i,l=U(v);if(!l.height||s(n))return;let d=!1;const u=U(a);d="up"===t?l.top-u.top<=e:u.bottom-l.bottom<=e,d&&(o.value=!0,r("update:loading",!0),r("load"))}))},j=()=>{if(i.finished){const e=t.finished?t.finished():i.finishedText;if(e)return g("div",{class:B("finished-text")},[e])}},T=()=>{r("update:error",!1),x()},b=()=>{if(i.error){const e=t.error?t.error():i.errorText;if(e)return g("div",{class:B("error-text"),onClick:T},[e])}},k=()=>{if(o.value&&!i.finished)return g("div",{class:B("loading")},[t.loading?t.loading():g(d,{class:B("loading-icon")},{default:()=>[i.loadingText||I("loading")]})])};return h([()=>i.loading,()=>i.finished,()=>i.error],x),f&&h(f,(e=>{e&&x()})),m((()=>{o.value=i.loading})),p((()=>{i.immediateCheck&&x()})),l({check:x}),S("scroll",x,{target:v}),()=>{var e;const r=null==(e=t.default)?void 0:e.call(t),s=g("div",{ref:a,class:B("placeholder")},null);return g("div",{ref:n,role:"feed",class:B(),"aria-busy":o.value},["down"===i.direction?r:s,k(),j(),b(),"up"===i.direction?r:s])}}}));const P=f({setup(e){const t=n({"zh-CN":{errorInfo:"错误提示",errorText:"请求失败，点击重新加载",pullRefresh:"下拉刷新",finishedText:"没有更多了"},"en-US":{errorInfo:"Error Info",errorText:"Request failed. Click to reload",pullRefresh:"PullRefresh",finishedText:"Finished"}}),o=u([{items:[],refreshing:!1,loading:!1,error:!1,finished:!1},{items:[],refreshing:!1,loading:!1,error:!1,finished:!1},{items:[],refreshing:!1,loading:!1,error:!1,finished:!1}]),s=e=>{const i=o.value[e];i.loading=!0,setTimeout((()=>{i.refreshing&&(i.items=[],i.refreshing=!1);for(let e=0;e<10;e++){const e=i.items.length+1;i.items.push(e<10?"0"+e:String(e))}i.loading=!1,i.refreshing=!1,1!==e||10!==i.items.length||i.error?i.error=!1:i.error=!0,i.items.length>=40&&(i.finished=!0)}),1e3)};return(e,n)=>(v(),x(T(r),null,{default:j((()=>[g(T(i),{title:T(t)("basicUsage")},{default:j((()=>[g(T(L),{loading:o.value[0].loading,"onUpdate:loading":n[0]||(n[0]=e=>o.value[0].loading=e),finished:o.value[0].finished,"finished-text":T(t)("finishedText"),onLoad:n[1]||(n[1]=e=>s(0))},{default:j((()=>[(v(!0),b(_,null,k(o.value[0].items,(e=>(v(),x(T(y),{key:e,title:e},null,8,["title"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["title"]),g(T(i),{title:T(t)("errorInfo")},{default:j((()=>[g(T(L),{loading:o.value[1].loading,"onUpdate:loading":n[2]||(n[2]=e=>o.value[1].loading=e),error:o.value[1].error,"onUpdate:error":n[3]||(n[3]=e=>o.value[1].error=e),finished:o.value[1].finished,"error-text":T(t)("errorText"),onLoad:n[4]||(n[4]=e=>s(1))},{default:j((()=>[(v(!0),b(_,null,k(o.value[1].items,(e=>(v(),x(T(y),{key:e,title:e},null,8,["title"])))),128))])),_:1},8,["loading","error","finished","error-text"])])),_:1},8,["title"]),g(T(i),{title:T(t)("pullRefresh")},{default:j((()=>[g(T(R),{modelValue:o.value[2].refreshing,"onUpdate:modelValue":n[7]||(n[7]=e=>o.value[2].refreshing=e),onRefresh:n[8]||(n[8]=e=>{return i=2,o.value[i].finished=!1,void s(i);var i})},{default:j((()=>[g(T(L),{loading:o.value[2].loading,"onUpdate:loading":n[5]||(n[5]=e=>o.value[2].loading=e),finished:o.value[2].finished,"finished-text":T(t)("finishedText"),onLoad:n[6]||(n[6]=e=>s(2))},{default:j((()=>[(v(!0),b(_,null,k(o.value[2].items,(e=>(v(),x(T(y),{key:e,title:e},null,8,["title"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])])),_:1},8,["title"])])),_:1}))}});export{P as default};
