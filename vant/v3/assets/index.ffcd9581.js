var J=Object.defineProperty,K=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var V=(e,o,a)=>o in e?J(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,C=(e,o)=>{for(var a in o||(o={}))W.call(o,a)&&V(e,a,o[a]);if(U)for(var a of U(o))X.call(o,a)&&V(e,a,o[a]);return e},x=(e,o)=>K(e,Q(o));import{c as $,i as N,U as R,a as ee}from"./use-translate.43484c14.js";import{t as w,b as P,m as B,c as oe,w as S,d as ne,a as _}from"./with-install.d47ea1a2.js";import{C as te}from"./index.f669a479.js";import{z as k,e as n,B as l,G as ae,x as A,M as se,j as ce,v as ue,q as ie,C as L,r as le,o as de,c as re,w as z,A as f}from"./vue-libs.f710b8ed.js";import{P as me}from"./index.26ad4b0e.js";import{u as pe}from"./use-refs.29822121.js";import{T as he,a as q}from"./index.77b903ee.js";import{F as be}from"./index.96f958b2.js";import{B as G}from"./index.fbdfcd01.js";import{C as ge}from"./index.e24742cc.js";import{T as fe}from"./function-call.fa74549a.js";import"./use-route.600bd02b.js";import"./index.2cac46c1.js";import"./constant.80c6de18.js";import"./interceptor.bbea64df.js";import"./use-expose.f4ec549a.js";import"./use-touch.8e5a0907.js";import"./use-lazy-render.c4d421a8.js";import"./on-popup-reopen.4b166a39.js";import"./index.bd0fe4b9.js";import"./index.0308b47a.js";import"./index.3fb10fdd.js";import"./index.da11a5bc.js";import"./Checker.aafe0e49.js";import"./mount-component.3a687679.js";const[ve,Y,M]=$("coupon-cell"),Ce={title:String,border:w,editable:w,coupons:P(),currency:B("\xA5"),chosenCoupon:oe(-1)};function xe({coupons:e,chosenCoupon:o,currency:a}){const u=e[+o];if(u){let t=0;return N(u.value)?{value:t}=u:N(u.denominations)&&(t=u.denominations),`-${a} ${(t/100).toFixed(2)}`}return e.length===0?M("noCoupon"):M("count",e.length)}var we=k({name:ve,props:Ce,setup(e){return()=>{const o=e.coupons[+e.chosenCoupon];return n(te,{class:Y(),value:xe(e),title:e.title||M("title"),border:e.border,isLink:e.editable,valueClass:Y("value",{selected:o})},null)}}});const Be=S(we);function O(e){const o=new Date(e*1e3);return`${o.getFullYear()}.${R(o.getMonth()+1)}.${R(o.getDate())}`}const je=e=>(e/10).toFixed(e%10==0?0:1),Z=e=>(e/100).toFixed(e%100==0?0:e%10==0?1:2),[ye,d,I]=$("coupon");var De=k({name:ye,props:{chosen:Boolean,coupon:ne(Object),disabled:Boolean,currency:B("\xA5")},setup(e){const o=l(()=>{const{startAt:t,endAt:s}=e.coupon;return`${O(t)} - ${O(s)}`}),a=l(()=>{const{coupon:t,currency:s}=e;if(t.valueDesc)return[t.valueDesc,n("span",null,[t.unitDesc||""])];if(t.denominations){const i=Z(t.denominations);return[n("span",null,[s]),` ${i}`]}return t.discount?I("discount",je(t.discount)):""}),u=l(()=>{const t=Z(e.coupon.originCondition||0);return t==="0"?I("unlimited"):I("condition",t)});return()=>{const{chosen:t,coupon:s,disabled:i}=e,b=i&&s.reason||s.description;return n("div",{class:d({disabled:i})},[n("div",{class:d("content")},[n("div",{class:d("head")},[n("h2",{class:d("amount")},[a.value]),n("p",{class:d("condition")},[s.condition||u.value])]),n("div",{class:d("body")},[n("p",{class:d("name")},[s.name]),n("p",{class:d("valid")},[o.value]),!i&&n(ge,{class:d("corner"),modelValue:t},null)])]),b&&n("p",{class:d("description")},[b])])}}});const H=S(De),[ke,r,v]=$("coupon-list"),Fe="https://img.yzcdn.cn/vant/coupon-empty.png",Ee={code:B(""),coupons:P(),currency:B("\xA5"),showCount:w,emptyImage:B(Fe),chosenCoupon:_(-1),enabledTitle:String,disabledTitle:String,disabledCoupons:P(),showExchangeBar:w,showCloseButton:w,closeButtonText:String,inputPlaceholder:String,exchangeMinLength:_(1),exchangeButtonText:String,displayedCouponIndex:_(-1),exchangeButtonLoading:Boolean,exchangeButtonDisabled:Boolean};var Te=k({name:ke,props:Ee,emits:["change","exchange","update:code"],setup(e,{emit:o,slots:a}){const[u,t]=pe(),s=ae({tab:0,code:e.code}),i=l(()=>!e.exchangeButtonLoading&&(e.exchangeButtonDisabled||!s.code||s.code.length<e.exchangeMinLength)),b=()=>{o("exchange",s.code),e.code||(s.code="")},j=c=>{ie(()=>{u.value[c]&&u.value[c].scrollIntoView()})},y=()=>n("div",{class:r("empty")},[n("img",{src:e.emptyImage},null),n("p",null,[v("noCoupon")])]),D=()=>{if(e.showExchangeBar)return n("div",{class:r("exchange-bar")},[n(be,{modelValue:s.code,"onUpdate:modelValue":c=>s.code=c,clearable:!0,border:!1,class:r("field"),placeholder:e.inputPlaceholder||v("placeholder"),maxlength:"20"},null),n(G,{plain:!0,type:"danger",class:r("exchange"),text:e.exchangeButtonText||v("exchange"),loading:e.exchangeButtonLoading,disabled:i.value,onClick:b},null)])},F=()=>{const{coupons:c}=e,m=e.showCount?` (${c.length})`:"",p=(e.enabledTitle||v("enable"))+m;return n(q,{title:p},{default:()=>{var g;return[n("div",{class:r("list",{"with-bar":e.showExchangeBar,"with-bottom":e.showCloseButton})},[c.map((h,T)=>n(H,{key:h.id,ref:t(T),coupon:h,chosen:T===e.chosenCoupon,currency:e.currency,onClick:()=>o("change",T)},null)),!c.length&&y(),(g=a["list-footer"])==null?void 0:g.call(a)])]}})},E=()=>{const{disabledCoupons:c}=e,m=e.showCount?` (${c.length})`:"",p=(e.disabledTitle||v("disabled"))+m;return n(q,{title:p},{default:()=>{var g;return[n("div",{class:r("list",{"with-bar":e.showExchangeBar,"with-bottom":e.showCloseButton})},[c.map(h=>n(H,{disabled:!0,key:h.id,coupon:h,currency:e.currency},null)),!c.length&&y(),(g=a["disabled-list-footer"])==null?void 0:g.call(a)])]}})};return A(()=>e.code,c=>{s.code=c}),A(()=>s.code,c=>o("update:code",c)),A(()=>e.displayedCouponIndex,j),se(()=>{j(e.displayedCouponIndex)}),()=>n("div",{class:r()},[D(),n(he,{active:s.tab,"onUpdate:active":c=>s.tab=c,class:r("tab"),border:!1},{default:()=>[F(),E()]}),n("div",{class:r("bottom")},[ce(n(G,{round:!0,block:!0,type:"danger",class:r("close"),text:e.closeButtonText||v("close"),onClick:()=>o("change",-1)},null),[[ue,e.showCloseButton]])])])}});const $e=S(Te),to=k({setup(e){const o=ee({"zh-CN":{coupon:{name:"\u4F18\u60E0\u5238\u540D\u79F0",reason:"\u4F18\u60E0\u5238\u4E0D\u53EF\u7528\u539F\u56E0",description:"\u63CF\u8FF0\u4FE1\u606F"},exchange:"\u5151\u6362\u6210\u529F"},"en-US":{coupon:{name:"Coupon name",reason:"Coupon unavailable reason",description:"Description"},exchange:"Success"}}),a=(m=999999)=>String(Math.floor(Math.random()*m)+1),u=L(!1),t=L(-1),s=L([]),i=l(()=>({id:1,condition:`\u65E0\u4F7F\u7528\u95E8\u69DB
\u6700\u591A\u4F18\u60E012\u5143`,reason:"",value:150,name:o("coupon.name"),description:o("coupon.description"),startAt:1489104e3,endAt:1514592e3,valueDesc:"1.5",unitDesc:"\u5143"})),b=l(()=>x(C({},i.value),{id:2,value:12,valueDesc:"8.8",unitDesc:"\u6298"})),j=l(()=>x(C({},i.value),{id:3,reason:o("coupon.reason")})),y=l(()=>x(C({},b.value),{valueDesc:"1",unitDesc:"\u6298",id:4,reason:o("coupon.reason")})),D=l(()=>[i.value,b.value,...s.value]),F=l(()=>[j.value,y.value]),E=m=>{u.value=!1,t.value=m},c=()=>{fe(o("exchange")),s.value.push(x(C({},i.value),{id:a()}))};return(m,p)=>{const g=le("demo-block");return de(),re(g,{title:f(o)("basicUsage")},{default:z(()=>[n(f(Be),{coupons:f(D),"chosen-coupon":t.value,onClick:p[0]||(p[0]=h=>u.value=!0)},null,8,["coupons","chosen-coupon"]),n(f(me),{show:u.value,"onUpdate:show":p[1]||(p[1]=h=>u.value=h),round:"",position:"bottom",style:{height:"90%","padding-top":"4px"}},{default:z(()=>[n(f($e),{coupons:f(D),"chosen-coupon":t.value,"disabled-coupons":f(F),onChange:E,onExchange:c},null,8,["coupons","chosen-coupon","disabled-coupons"])]),_:1},8,["show"])]),_:1},8,["title"])}}});export{to as default};
