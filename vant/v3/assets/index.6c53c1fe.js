import{t as e}from"./use-translate.b583725c.js";import{c as a,w as l}from"./with-install.62f47d2f.js";import{p as o}from"./event.7d40caae.js";import{a as t}from"./unit.49c29796.js";import{u as r}from"./use-refs.7144ba67.js";import{u as s}from"./use-touch.ce80657e.js";import{I as i}from"./index.3af24151.js";import{A as n,D as u,e as d}from"./vendor.ef334a89.js";import{u as c}from"./index.49199c0d.js";const[f,m]=a("rate");const p=l(n({name:f,props:{size:[Number,String],color:String,gutter:[Number,String],readonly:Boolean,disabled:Boolean,allowHalf:Boolean,voidColor:String,touchable:e,iconPrefix:String,disabledColor:String,modelValue:{type:Number,default:0},icon:{type:String,default:"star"},voidIcon:{type:String,default:"star-o"},count:{type:[Number,String],default:5}},emits:["change","update:modelValue"],setup(e,{emit:a}){const l=s(),[n,f]=r(),p=()=>e.readonly||e.disabled||!e.touchable,h=u((()=>Array(+e.count).fill("").map(((a,l)=>function(e,a,l,o){if(e>=a)return{status:"full",value:1};if(e+.5>=a&&l&&!o)return{status:"half",value:.5};if(e+1>=a&&l&&o){const l=10**10;return{status:"half",value:Math.round((e-a+1)*l)/l}}return{status:"void",value:0}}(e.modelValue,l+1,e.allowHalf,e.readonly)))));let v;const b=()=>{const a=n.value.map((e=>e.getBoundingClientRect()));v=[],a.forEach(((a,l)=>{e.allowHalf?v.push({score:l+.5,left:a.left},{score:l+1,left:a.left+a.width/2}):v.push({score:l+1,left:a.left})}))},g=a=>{for(let e=v.length-1;e>0;e--)if(a>v[e].left)return v[e].score;return e.allowHalf?.5:1},y=l=>{e.disabled||e.readonly||l===e.modelValue||(a("update:modelValue",l),a("change",l))},j=e=>{p()||(l.start(e),b())},w=e=>{if(!p()&&(l.move(e),l.isHorizontal())){const{clientX:a}=e.touches[0];o(e),y(g(a))}},x=(a,l)=>{const{icon:o,size:r,color:s,count:n,gutter:u,voidIcon:c,disabled:p,voidColor:h,allowHalf:v,iconPrefix:j,disabledColor:w}=e,x=l+1,S="full"===a.status,z="void"===a.status,C=v&&a.value>0&&a.value<1;let H;u&&x!==+n&&(H={paddingRight:t(u)});return d("div",{key:l,ref:f(l),role:"radio",style:H,class:m("item"),tabindex:0,"aria-setsize":+n,"aria-posinset":x,"aria-checked":!z,onClick:e=>{b(),y(v?g(e.clientX):x)}},[d(i,{size:r,name:S?o:c,class:m("icon",{disabled:p,full:S}),color:p?w:S?s:h,classPrefix:j},null),C&&d(i,{size:r,style:{width:a.value+"em"},name:z?c:o,class:m("icon",["half",{disabled:p,full:!z}]),color:p?w:z?h:s,classPrefix:j},null)])};return c((()=>e.modelValue)),()=>d("div",{role:"radiogroup",class:m({readonly:e.readonly,disabled:e.disabled}),tabindex:0,onTouchstart:j,onTouchmove:w},[h.value.map(x)])}}));export{p as R};
