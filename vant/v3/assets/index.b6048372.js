import{t as e,i as t}from"./use-translate.b583725c.js";import{c as a,r as l,w as n}from"./with-install.62f47d2f.js";import{A as u,E as s,D as i,y as o,e as r,l as m,v as d,J as p,s as c}from"./vendor.ef334a89.js";import{p as b}from"./event.7d40caae.js";import{c as g}from"./interceptor.ab1192d4.js";import{a as v,g as h}from"./unit.49c29796.js";import{f,a as S}from"./number.b01aa591.js";import{u as y}from"./index.49199c0d.js";const[w,N]=a("stepper");function x(e,t){return String(e)===String(t)}const V=n(u({name:w,props:{theme:String,integer:Boolean,disabled:Boolean,showPlus:e,showMinus:e,showInput:e,longPress:e,allowEmpty:Boolean,modelValue:[Number,String],inputWidth:[Number,String],buttonSize:[Number,String],placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,decimalLength:[Number,String],name:{type:[Number,String],default:""},min:{type:[Number,String],default:1},max:{type:[Number,String],default:1/0},step:{type:[Number,String],default:1},defaultValue:{type:[Number,String],default:1}},emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(e,{emit:a}){const n=a=>{const{min:l,max:n,allowEmpty:u,decimalLength:s}=e;return u&&""===a||(a=""===(a=f(String(a),!e.integer))?0:+a,a=Number.isNaN(a)?+l:a,a=Math.max(Math.min(+n,a),+l),t(s)&&(a=a.toFixed(+s))),a};let u;const w=s(),V=s((()=>{var t;const l=null!=(t=e.modelValue)?t:e.defaultValue,u=n(l);return x(u,e.modelValue)||a("update:modelValue",u),u})()),j=i((()=>e.disabled||e.disableMinus||V.value<=+e.min)),B=i((()=>e.disabled||e.disablePlus||V.value>=+e.max)),I=i((()=>({width:v(e.inputWidth),height:v(e.buttonSize)}))),M=i((()=>h(e.buttonSize))),P=t=>{e.beforeChange?g({args:[t],interceptor:e.beforeChange,done(){V.value=t}}):V.value=t},T=()=>{if("plus"===u&&B.value||"minus"===u&&j.value)return void a("overlimit",u);const t="minus"===u?-e.step:+e.step,l=n(S(+V.value,t));P(l),a(u)},C=a=>{const l=a.target,{value:n}=l,{decimalLength:u}=e;let s=f(String(n),!e.integer);if(t(u)&&s.includes(".")){const e=s.split(".");s=`${e[0]}.${e[1].slice(0,+u)}`}e.beforeChange?l.value=String(V.value):x(n,s)||(l.value=s);const i=s===String(+s);P(i?+s:s)},L=t=>{var l;e.disableInput?null==(l=w.value)||l.blur():a("focus",t)},z=e=>{const t=e.target,u=n(t.value);t.value=String(u),V.value=u,c((()=>{a("blur",e),l()}))};let D,E;const F=()=>{E=setTimeout((()=>{T(),F()}),200)},W=t=>{e.longPress&&(clearTimeout(E),D&&b(t))},$=t=>{e.disableInput&&t.preventDefault()},k=t=>({onClick:e=>{e.preventDefault(),u=t,T()},onTouchstart:()=>{u=t,e.longPress&&(D=!1,clearTimeout(E),E=setTimeout((()=>{D=!0,T(),F()}),600))},onTouchend:W,onTouchcancel:W});return o([()=>e.max,()=>e.min,()=>e.integer,()=>e.decimalLength],(()=>{const e=n(V.value);x(e,V.value)||(V.value=e)})),o((()=>e.modelValue),(e=>{x(e,V.value)||(V.value=n(e))})),o(V,(t=>{a("update:modelValue",t),a("change",t,{name:e.name})})),y((()=>e.modelValue)),()=>r("div",{class:N([e.theme])},[m(r("button",p({type:"button",style:M.value,class:N("minus",{disabled:j.value})},k("minus")),null),[[d,e.showMinus]]),m(r("input",{ref:w,type:e.integer?"tel":"text",role:"spinbutton",class:N("input"),value:V.value,style:I.value,disabled:e.disabled,readonly:e.disableInput,inputmode:e.integer?"numeric":"decimal",placeholder:e.placeholder,"aria-valuemax":+e.max,"aria-valuemin":+e.min,"aria-valuenow":+V.value,onBlur:z,onInput:C,onFocus:L,onMousedown:$},null),[[d,e.showInput]]),m(r("button",p({type:"button",style:M.value,class:N("plus",{disabled:B.value})},k("plus")),null),[[d,e.showPlus]])])}}));export{V as S};
