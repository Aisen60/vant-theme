import{c as e,t,g as a,j as l,x as n,i as u,J as s,y as i,p as o}from"./use-translate.91889477.js";import{w as r}from"./with-install.c9eedd0e.js";import{z as m,D as d,C as p,x as c,e as b,k as g,v,I as h,q as f}from"./vue-libs.71fdcafc.js";import{c as S}from"./interceptor.fd551ac3.js";import{u as y}from"./index.a16d08bc.js";const[w,x]=e("stepper"),N=(e,t)=>String(e)===String(t);const V=r(m({name:w,props:{theme:String,integer:Boolean,disabled:Boolean,showPlus:t,showMinus:t,showInput:t,longPress:t,allowEmpty:Boolean,modelValue:[Number,String],inputWidth:[Number,String],buttonSize:[Number,String],placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,decimalLength:[Number,String],name:{type:[Number,String],default:""},min:{type:[Number,String],default:1},max:{type:[Number,String],default:1/0},step:{type:[Number,String],default:1},defaultValue:{type:[Number,String],default:1}},emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(e,{emit:t}){const r=t=>{const{min:a,max:l,allowEmpty:s,decimalLength:i}=e;return s&&""===t||(t=""===(t=n(String(t),!e.integer))?0:+t,t=Number.isNaN(t)?+a:t,t=Math.max(Math.min(+l,t),+a),u(i)&&(t=t.toFixed(+i))),t};let m;const w=d(),V=d((()=>{var a;const l=null!=(a=e.modelValue)?a:e.defaultValue,n=r(l);return N(n,e.modelValue)||t("update:modelValue",n),n})()),I=p((()=>e.disabled||e.disableMinus||V.value<=+e.min)),B=p((()=>e.disabled||e.disablePlus||V.value>=+e.max)),M=p((()=>({width:a(e.inputWidth),height:a(e.buttonSize)}))),P=p((()=>l(e.buttonSize))),T=t=>{e.beforeChange?S({args:[t],interceptor:e.beforeChange,done(){V.value=t}}):V.value=t},j=()=>{if("plus"===m&&B.value||"minus"===m&&I.value)return void t("overlimit",m);const a="minus"===m?-e.step:+e.step,l=r(s(+V.value,a));T(l),t(m)},C=t=>{const a=t.target,{value:l}=a,{decimalLength:s}=e;let i=n(String(l),!e.integer);if(u(s)&&i.includes(".")){const e=i.split(".");i=`${e[0]}.${e[1].slice(0,+s)}`}e.beforeChange?a.value=String(V.value):N(l,i)||(a.value=i);const o=i===String(+i);T(o?+i:i)},z=a=>{var l;e.disableInput?null==(l=w.value)||l.blur():t("focus",a)},L=e=>{const a=e.target,l=r(a.value);a.value=String(l),V.value=l,f((()=>{t("blur",e),i()}))};let D,F;const k=()=>{F=setTimeout((()=>{j(),k()}),200)},E=t=>{e.longPress&&(clearTimeout(F),D&&o(t))},W=t=>{e.disableInput&&t.preventDefault()},$=t=>({onClick:e=>{e.preventDefault(),m=t,j()},onTouchstart:()=>{m=t,e.longPress&&(D=!1,clearTimeout(F),F=setTimeout((()=>{D=!0,j(),k()}),600))},onTouchend:E,onTouchcancel:E});return c([()=>e.max,()=>e.min,()=>e.integer,()=>e.decimalLength],(()=>{const e=r(V.value);N(e,V.value)||(V.value=e)})),c((()=>e.modelValue),(e=>{N(e,V.value)||(V.value=r(e))})),c(V,(a=>{t("update:modelValue",a),t("change",a,{name:e.name})})),y((()=>e.modelValue)),()=>b("div",{class:x([e.theme])},[g(b("button",h({type:"button",style:P.value,class:x("minus",{disabled:I.value})},$("minus")),null),[[v,e.showMinus]]),g(b("input",{ref:w,type:e.integer?"tel":"text",role:"spinbutton",class:x("input"),value:V.value,style:M.value,disabled:e.disabled,readonly:e.disableInput,inputmode:e.integer?"numeric":"decimal",placeholder:e.placeholder,"aria-valuemax":+e.max,"aria-valuemin":+e.min,"aria-valuenow":+V.value,onBlur:L,onInput:C,onFocus:z,onMousedown:W},null),[[v,e.showInput]]),g(b("button",h({type:"button",style:P.value,class:x("plus",{disabled:B.value})},$("plus")),null),[[v,e.showPlus]])])}}));export{V as S};
