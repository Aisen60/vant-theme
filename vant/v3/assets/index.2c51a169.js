import{a as t,T as e}from"./index.49dfe0ad.js";import{i as s,t as i,e as o,a as n}from"./use-translate.b583725c.js";import{c as r,b as a,s as l,g as c,w as d}from"./with-install.62f47d2f.js";import{i as u}from"./style.21d4b335.js";import{p}from"./event.7d40caae.js";import{u as f}from"./use-touch.ce80657e.js";import{u as m}from"./use-expose.33de0944.js";import{A as h,E as x,D as g,H as v,y as j,e as b,R as y,B as C,s as k,G as w,o as S,c as I,w as T,C as L,a as O,b as A,d as z,F as $,i as _,t as R}from"./vendor.ef334a89.js";import{u as N}from"./index.253cf6b3.js";import{u as B}from"./useChildren.a94b5b99.js";import{u as U}from"./index.7e292110.js";import{u as E}from"./index.90a1ecc4.js";import{f as F}from"./constant.4d85ecb9.js";import{b as P}from"./unit.49c29796.js";import{u as V}from"./useParent.0a2f50cb.js";import{C as D}from"./index.550f913c.js";import"./use-route.3fda2186.js";import"./index.c15090cc.js";import"./number.b01aa591.js";import"./on-popup-reopen.522dc00c.js";import"./utils.b0356070.js";import"./interceptor.ab1192d4.js";import"./use-refs.7144ba67.js";import"./index.a7e6e774.js";import"./index.3af24151.js";const[G,H]=r("index-bar"),M={sticky:i,zIndex:[Number,String],teleport:[String,Object],highlightColor:String,stickyOffsetTop:{type:Number,default:0},indexList:{type:Array,default:function(){const t="A".charCodeAt(0);return Array(26).fill("").map(((e,s)=>String.fromCharCode(t+s)))}}},X=Symbol(G);const Y=d(h({name:G,props:M,emits:["select","change"],setup(t,{emit:e,slots:i}){const o=x(),n=x(""),r=f(),d=N(o),{children:h,linkChildren:w}=B(X);w({props:t});const S=g((()=>{if(s(t.zIndex))return{zIndex:+t.zIndex+1}})),I=g((()=>{if(t.highlightColor)return{color:t.highlightColor}})),T=()=>{if(u(o))return;const{sticky:e,indexList:s}=t,i=a(d.value),r="getBoundingClientRect"in d.value?E(d):{top:0,left:0},l=h.map((t=>t.getRect(d.value,r))),c=((e,s)=>{for(let i=h.length-1;i>=0;i--){const o=i>0?s[i-1].height:0;if(e+(t.sticky?o+t.stickyOffsetTop:0)>=s[i].top)return i}return-1})(i,l);n.value=s[c],e&&h.forEach(((e,s)=>{const{state:o,$el:n}=e;if(s===c||s===c-1){const t=n.getBoundingClientRect();o.left=t.left,o.width=t.width}else o.left=null,o.width=null;if(s===c)o.active=!0,o.top=Math.max(t.stickyOffsetTop,l[s].top-i)+r.top;else if(s===c-1){const t=l[c].top-i;o.active=t>0,o.top=t+r.top-l[s].height}else o.active=!1}))},L=()=>k(T);U("scroll",T,{target:d}),v(L),j((()=>t.indexList),L),j(n,(t=>{t&&e("change",t)}));const O=s=>{s=String(s);const i=h.find((t=>String(t.index)===s));i&&(i.$el.scrollIntoView(),t.sticky&&t.stickyOffsetTop&&l(c()-t.stickyOffsetTop),e("select",i.index))},A=t=>{const{index:e}=t.dataset;e&&O(e)},z=t=>{A(t.target)};let $;const _=t=>{if(r.move(t),r.isVertical()){p(t);const{clientX:e,clientY:s}=t.touches[0],i=document.elementFromPoint(e,s);if(i){const{index:t}=i.dataset;t&&$!==t&&($=t,A(i))}}},R=()=>b("div",{class:H("sidebar"),style:S.value,onClick:z,onTouchstart:r.start,onTouchmove:_},[t.indexList.map((t=>{const e=t===n.value;return b("span",{class:H("index",{active:e}),style:e?I.value:void 0,"data-index":t},[t])}))]);return m({scrollTo:O}),()=>{var e;let s;return b("div",{ref:o,class:H()},[t.teleport?b(y,{to:t.teleport},(n=s=R(),"function"==typeof n||"[object Object]"===Object.prototype.toString.call(n)&&!C(n)?s:{default:()=>[s]})):R(),null==(e=i.default)?void 0:e.call(i)]);var n}}})),[q,J]=r("index-anchor");const K=d(h({name:q,props:{index:[Number,String]},setup(t,{slots:e}){const s=w({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),i=x(),{parent:n}=V(X);if(!n)return;const r=()=>s.active&&n.props.sticky,l=g((()=>{const{zIndex:t,highlightColor:e}=n.props;if(r())return o(P(t),{left:s.left?`${s.left}px`:void 0,width:s.width?`${s.width}px`:void 0,transform:s.top?`translate3d(0, ${s.top}px, 0)`:void 0,color:e})}));return m({state:s,getRect:(t,e)=>{const o=E(i);return s.rect.height=o.height,t===window||t===document.body?s.rect.top=o.top+c():s.rect.top=o.top+a(t)-e.top,s.rect}}),()=>{const o=r();return b("div",{ref:i,style:{height:o?`${s.rect.height}px`:void 0}},[b("div",{style:l.value,class:[J({sticky:o}),{[F]:o}]},[e.default?e.default():t.index])])}}})),Q=h({setup(s){const i=n({"zh-CN":{text:"文本",customIndexList:"自定义索引列表"},"en-US":{text:"Text",customIndexList:"Custom Index List"}}),o=x(0),r=[],a=[1,2,3,4,5,6,8,9,10],l="A".charCodeAt(0);for(let t=0;t<26;t++)r.push(String.fromCharCode(l+t));return(s,n)=>(S(),I(L(e),{active:o.value,"onUpdate:active":n[0]||(n[0]=t=>o.value=t)},{default:T((()=>[b(L(t),{title:L(i)("basicUsage")},{default:T((()=>[b(L(Y),null,{default:T((()=>[(S(),O($,null,A(r,(t=>z("div",{key:t},[b(L(K),{index:t},null,8,["index"]),b(L(D),{title:L(i)("text")},null,8,["title"]),b(L(D),{title:L(i)("text")},null,8,["title"]),b(L(D),{title:L(i)("text")},null,8,["title"])]))),64))])),_:1})])),_:1},8,["title"]),b(L(t),{title:L(i)("customIndexList")},{default:T((()=>[b(L(Y),{"index-list":a},{default:T((()=>[(S(),O($,null,A(a,(t=>z("div",{key:t},[b(L(K),{index:t},{default:T((()=>[_(R(L(i)("title")+t),1)])),_:2},1032,["index"]),b(L(D),{title:L(i)("text")},null,8,["title"]),b(L(D),{title:L(i)("text")},null,8,["title"]),b(L(D),{title:L(i)("text")},null,8,["title"])]))),64))])),_:1})])),_:1},8,["title"])])),_:1},8,["active"]))}});export{Q as default};
