import{c as e,t as l,p as a,g as t}from"./use-translate.91889477.js";import{w as o}from"./with-install.c9eedd0e.js";import{u as s}from"./use-refs.6c094865.js";import{u as r}from"./use-touch.30351383.js";import{I as i}from"./index.d38d9435.js";import{z as n,C as u,e as d}from"./vue-libs.71fdcafc.js";import{u as c}from"./index.a16d08bc.js";const[f,m]=e("rate");const p=o(n({name:f,props:{size:[Number,String],color:String,gutter:[Number,String],readonly:Boolean,disabled:Boolean,allowHalf:Boolean,voidColor:String,touchable:l,iconPrefix:String,disabledColor:String,modelValue:{type:Number,default:0},icon:{type:String,default:"star"},voidIcon:{type:String,default:"star-o"},count:{type:[Number,String],default:5}},emits:["change","update:modelValue"],setup(e,{emit:l}){const o=r(),[n,f]=s(),p=()=>e.readonly||e.disabled||!e.touchable,h=u((()=>Array(+e.count).fill("").map(((l,a)=>function(e,l,a,t){if(e>=l)return{status:"full",value:1};if(e+.5>=l&&a&&!t)return{status:"half",value:.5};if(e+1>=l&&a&&t){const a=10**10;return{status:"half",value:Math.round((e-l+1)*a)/a}}return{status:"void",value:0}}(e.modelValue,a+1,e.allowHalf,e.readonly)))));let b;const g=()=>{const l=n.value.map((e=>e.getBoundingClientRect()));b=[],l.forEach(((l,a)=>{e.allowHalf?b.push({score:a+.5,left:l.left},{score:a+1,left:l.left+l.width/2}):b.push({score:a+1,left:l.left})}))},v=l=>{for(let e=b.length-1;e>0;e--)if(l>b[e].left)return b[e].score;return e.allowHalf?.5:1},y=a=>{e.disabled||e.readonly||a===e.modelValue||(l("update:modelValue",a),l("change",a))},w=e=>{p()||(o.start(e),g())},x=e=>{if(!p()&&(o.move(e),o.isHorizontal())){const{clientX:l}=e.touches[0];a(e),y(v(l))}},S=(l,a)=>{const{icon:o,size:s,color:r,count:n,gutter:u,voidIcon:c,disabled:p,voidColor:h,allowHalf:b,iconPrefix:w,disabledColor:x}=e,S=a+1,j="full"===l.status,z="void"===l.status,C=b&&l.value>0&&l.value<1;let H;u&&S!==+n&&(H={paddingRight:t(u)});return d("div",{key:a,ref:f(a),role:"radio",style:H,class:m("item"),tabindex:0,"aria-setsize":+n,"aria-posinset":S,"aria-checked":!z,onClick:e=>{g(),y(b?v(e.clientX):S)}},[d(i,{size:s,name:j?o:c,class:m("icon",{disabled:p,full:j}),color:p?x:j?r:h,classPrefix:w},null),C&&d(i,{size:s,style:{width:l.value+"em"},name:z?c:o,class:m("icon",["half",{disabled:p,full:!z}]),color:p?x:z?h:r,classPrefix:w},null)])};return c((()=>e.modelValue)),()=>d("div",{role:"radiogroup",class:m({readonly:e.readonly,disabled:e.disabled}),tabindex:0,onTouchstart:w,onTouchmove:x},[h.value.map(S)])}}));export{p as R};
