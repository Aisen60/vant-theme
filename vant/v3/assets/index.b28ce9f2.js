import{a as t,T as e}from"./index.c005411f.js";import{c as s,i,t as o,p as n,E as l,D as r,v as a,s as c,e as d,m as u,a as p}from"./use-translate.91889477.js";import{w as f}from"./with-install.c9eedd0e.js";import{u as m}from"./use-touch.30351383.js";import{u as h}from"./use-expose.5ea79906.js";import{z as x,D as v,C as g,G as j,x as y,e as b,Q as C,A as k,q as w,E as S,o as I,c as T,w as L,B as O,a as z,b as A,d as $,F as _,h as N,t as R}from"./vue-libs.71fdcafc.js";import{u as B}from"./index.9e2e36ca.js";import{u as E}from"./useChildren.edf9a3d1.js";import{u as U}from"./index.94f7437a.js";import{u as D}from"./index.43faf238.js";import{f as F}from"./constant.4d85ecb9.js";import{u as P}from"./useParent.e4fd6deb.js";import{C as V}from"./index.5d323f2c.js";import"./use-route.913efdd2.js";import"./index.0a6905cd.js";import"./on-popup-reopen.d7054786.js";import"./utils.b0356070.js";import"./interceptor.fd551ac3.js";import"./use-refs.6c094865.js";import"./index.2b3be213.js";import"./index.d38d9435.js";const[q,G]=s("index-bar"),M={sticky:o,zIndex:[Number,String],teleport:[String,Object],highlightColor:String,stickyOffsetTop:{type:Number,default:0},indexList:{type:Array,default:function(){const t="A".charCodeAt(0);return Array(26).fill("").map(((e,s)=>String.fromCharCode(t+s)))}}},Q=Symbol(q);const X=f(x({name:q,props:M,emits:["select","change"],setup(t,{emit:e,slots:s}){const o=v(),d=v(""),u=m(),p=B(o),{children:f,linkChildren:x}=E(Q);x({props:t});const S=g((()=>{if(i(t.zIndex))return{zIndex:+t.zIndex+1}})),I=g((()=>{if(t.highlightColor)return{color:t.highlightColor}})),T=()=>{if(l(o))return;const{sticky:e,indexList:s}=t,i=r(p.value),n="getBoundingClientRect"in p.value?D(p):{top:0,left:0},a=f.map((t=>t.getRect(p.value,n))),c=((e,s)=>{for(let i=f.length-1;i>=0;i--){const o=i>0?s[i-1].height:0;if(e+(t.sticky?o+t.stickyOffsetTop:0)>=s[i].top)return i}return-1})(i,a);d.value=s[c],e&&f.forEach(((e,s)=>{const{state:o,$el:l}=e;if(s===c||s===c-1){const t=l.getBoundingClientRect();o.left=t.left,o.width=t.width}else o.left=null,o.width=null;if(s===c)o.active=!0,o.top=Math.max(t.stickyOffsetTop,a[s].top-i)+n.top;else if(s===c-1){const t=a[c].top-i;o.active=t>0,o.top=t+n.top-a[s].height}else o.active=!1}))},L=()=>w(T);U("scroll",T,{target:p}),j(L),y((()=>t.indexList),L),y(d,(t=>{t&&e("change",t)}));const O=s=>{s=String(s);const i=f.find((t=>String(t.index)===s));i&&(i.$el.scrollIntoView(),t.sticky&&t.stickyOffsetTop&&a(c()-t.stickyOffsetTop),e("select",i.index))},z=t=>{const{index:e}=t.dataset;e&&O(e)},A=t=>{z(t.target)};let $;const _=t=>{if(u.move(t),u.isVertical()){n(t);const{clientX:e,clientY:s}=t.touches[0],i=document.elementFromPoint(e,s);if(i){const{index:t}=i.dataset;t&&$!==t&&($=t,z(i))}}},N=()=>b("div",{class:G("sidebar"),style:S.value,onClick:A,onTouchstart:u.start,onTouchmove:_},[t.indexList.map((t=>{const e=t===d.value;return b("span",{class:G("index",{active:e}),style:e?I.value:void 0,"data-index":t},[t])}))]);return h({scrollTo:O}),()=>{var e;let i;return b("div",{ref:o,class:G()},[t.teleport?b(C,{to:t.teleport},(n=i=N(),"function"==typeof n||"[object Object]"===Object.prototype.toString.call(n)&&!k(n)?i:{default:()=>[i]})):N(),null==(e=s.default)?void 0:e.call(s)]);var n}}})),[Y,H]=s("index-anchor");const J=f(x({name:Y,props:{index:[Number,String]},setup(t,{slots:e}){const s=S({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),i=v(),{parent:o}=P(Q);if(!o)return;const n=()=>s.active&&o.props.sticky,l=g((()=>{const{zIndex:t,highlightColor:e}=o.props;if(n())return d(u(t),{left:s.left?`${s.left}px`:void 0,width:s.width?`${s.width}px`:void 0,transform:s.top?`translate3d(0, ${s.top}px, 0)`:void 0,color:e})}));return h({state:s,getRect:(t,e)=>{const o=D(i);return s.rect.height=o.height,t===window||t===document.body?s.rect.top=o.top+c():s.rect.top=o.top+r(t)-e.top,s.rect}}),()=>{const o=n();return b("div",{ref:i,style:{height:o?`${s.rect.height}px`:void 0}},[b("div",{style:l.value,class:[H({sticky:o}),{[F]:o}]},[e.default?e.default():t.index])])}}})),K=x({setup(s){const i=p({"zh-CN":{text:"文本",customIndexList:"自定义索引列表"},"en-US":{text:"Text",customIndexList:"Custom Index List"}}),o=v(0),n=[],l=[1,2,3,4,5,6,8,9,10],r="A".charCodeAt(0);for(let t=0;t<26;t++)n.push(String.fromCharCode(r+t));return(s,r)=>(I(),T(O(e),{active:o.value,"onUpdate:active":r[0]||(r[0]=t=>o.value=t)},{default:L((()=>[b(O(t),{title:O(i)("basicUsage")},{default:L((()=>[b(O(X),null,{default:L((()=>[(I(),z(_,null,A(n,(t=>$("div",{key:t},[b(O(J),{index:t},null,8,["index"]),b(O(V),{title:O(i)("text")},null,8,["title"]),b(O(V),{title:O(i)("text")},null,8,["title"]),b(O(V),{title:O(i)("text")},null,8,["title"])]))),64))])),_:1})])),_:1},8,["title"]),b(O(t),{title:O(i)("customIndexList")},{default:L((()=>[b(O(X),{"index-list":l},{default:L((()=>[(I(),z(_,null,A(l,(t=>$("div",{key:t},[b(O(J),{index:t},{default:L((()=>[N(R(O(i)("title")+t),1)])),_:2},1032,["index"]),b(O(V),{title:O(i)("text")},null,8,["title"]),b(O(V),{title:O(i)("text")},null,8,["title"]),b(O(V),{title:O(i)("text")},null,8,["title"])]))),64))])),_:1})])),_:1},8,["title"])])),_:1},8,["active"]))}});export{K as default};
