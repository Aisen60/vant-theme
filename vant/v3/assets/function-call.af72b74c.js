import{c as N,p as L,i as D,e as d,a as U,b as V}from"./use-translate.33b17133.js";import{m as w,n as x,a as E,u as S,w as H}from"./with-install.d00852e2.js";import{m as q,u as G}from"./mount-component.4efac25f.js";import{I as $}from"./index.0a08d1ef.js";import{P as A}from"./index.9f327319.js";import{L as F}from"./index.58fe8242.js";import{z as J,x as b,E as K,G as Q,e as r,H as I,C as R,I as W}from"./vue-libs.7d3cdfcb.js";let m=0;function X(e){e?(m||document.body.classList.add("van-toast--unclickable"),m++):m&&(m--,m||document.body.classList.remove("van-toast--unclickable"))}const[Y,g]=N("toast"),Z=["show","overlay","transition","overlayClass","overlayStyle","closeOnClickOverlay"],_={icon:String,show:Boolean,type:w("text"),overlay:Boolean,message:x,iconSize:x,duration:E(2e3),position:w("middle"),className:S,iconPrefix:String,transition:w("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:S,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var T=J({name:Y,props:_,emits:["update:show"],setup(e,{emit:n}){let o,f=!1;const l=()=>{const a=e.show&&e.forbidClick;f!==a&&(f=a,X(f))},u=a=>n("update:show",a),k=()=>{e.closeOnClick&&u(!1)},p=()=>clearTimeout(o),v=()=>{const{icon:a,type:i,iconSize:P,iconPrefix:z,loadingType:B}=e;if(a||i==="success"||i==="fail")return r($,{name:a||i,size:P,class:g("icon"),classPrefix:z},null);if(i==="loading")return r(F,{class:g("loading"),size:P,type:B},null)},c=()=>{const{type:a,message:i}=e;if(D(i)&&i!=="")return a==="html"?r("div",{class:g("text"),innerHTML:String(i)},null):r("div",{class:g("text")},[i])};return b(()=>[e.show,e.forbidClick],l),b(()=>[e.show,e.type,e.message,e.duration],()=>{p(),e.show&&e.duration>0&&(o=setTimeout(()=>{u(!1)},e.duration))}),K(l),Q(l),()=>r(A,I({class:[g([e.position,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:k,onClosed:p,"onUpdate:show":u},L(e,Z)),{default:()=>[v(),c()]})}});const j={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let t=[],y=!1,h=d({},j);const C=new Map;function M(e){return V(e)?e:{message:e}}function ee(){const{instance:e,unmount:n}=q({setup(){const o=R(""),{open:f,state:l,close:u,toggle:k}=G(),p=()=>{y&&(t=t.filter(c=>c!==e),n())},v=()=>r(T,I(l,{onClosed:p,"onUpdate:show":k}),null);return b(o,c=>{l.message=c}),W().render=v,{open:f,clear:u,message:o}}});return e}function ne(){if(!t.length||y){const e=ee();t.push(e)}return t[t.length-1]}function s(e={}){if(!U)return{};const n=ne(),o=M(e);return n.open(d({},h,C.get(o.type||h.type),o)),n}const O=e=>n=>s(d({type:e},M(n)));s.loading=O("loading");s.success=O("success");s.fail=O("fail");s.clear=e=>{var n;t.length&&(e?(t.forEach(o=>{o.clear()}),t=[]):y?(n=t.shift())==null||n.clear():t[0].clear())};function te(e,n){typeof e=="string"?C.set(e,n):d(h,e)}s.setDefaultOptions=te;s.resetDefaultOptions=e=>{typeof e=="string"?C.delete(e):(h=d({},j),C.clear())};s.allowMultiple=(e=!0)=>{y=e};s.install=e=>{e.use(H(T)),e.config.globalProperties.$toast=s};export{s as T};
