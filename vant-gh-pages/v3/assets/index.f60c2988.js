import{t as e}from"./use-translate.bf1abf23.js";import{c as a,w as l}from"./with-install.af140ae3.js";import{p as o}from"./event.7d40caae.js";import{a as t}from"./unit.36efb2dd.js";import{u as r}from"./use-refs.b4c6d67f.js";import{u as s}from"./use-touch.871001cd.js";import{I as i}from"./index.5afcfd01.js";import{B as n,E as u,f as d}from"./vendor.09b5b9a9.js";import{u as f}from"./index.e6355079.js";const[c,m]=a("rate");const p=l(n({name:c,props:{size:[Number,String],color:String,gutter:[Number,String],readonly:Boolean,disabled:Boolean,allowHalf:Boolean,voidColor:String,touchable:e,iconPrefix:String,disabledColor:String,modelValue:{type:Number,default:0},icon:{type:String,default:"star"},voidIcon:{type:String,default:"star-o"},count:{type:[Number,String],default:5}},emits:["change","update:modelValue"],setup(e,{emit:a}){const l=s(),[n,c]=r(),p=()=>e.readonly||e.disabled||!e.touchable,b=u((()=>Array(+e.count).fill("").map(((a,l)=>function(e,a,l,o){if(e>=a)return{status:"full",value:1};if(e+.5>=a&&l&&!o)return{status:"half",value:.5};if(e+1>=a&&l&&o){const l=10**10;return{status:"half",value:Math.round((e-a+1)*l)/l}}return{status:"void",value:0}}(e.modelValue,l+1,e.allowHalf,e.readonly)))));let h;const v=()=>{const a=n.value.map((e=>e.getBoundingClientRect()));h=[],a.forEach(((a,l)=>{e.allowHalf?h.push({score:l+.5,left:a.left},{score:l+1,left:a.left+a.width/2}):h.push({score:l+1,left:a.left})}))},g=a=>{for(let e=h.length-1;e>0;e--)if(a>h[e].left)return h[e].score;return e.allowHalf?.5:1},y=l=>{e.disabled||e.readonly||l===e.modelValue||(a("update:modelValue",l),a("change",l))},j=e=>{p()||(l.start(e),v())},w=e=>{if(!p()&&(l.move(e),l.isHorizontal())){const{clientX:a}=e.touches[0];o(e),y(g(a))}},x=(a,l)=>{const{icon:o,size:r,color:s,count:n,gutter:u,voidIcon:f,disabled:p,voidColor:b,allowHalf:h,iconPrefix:j,disabledColor:w}=e,x=l+1,S="full"===a.status,z="void"===a.status,C=h&&a.value>0&&a.value<1;let H;u&&x!==+n&&(H={paddingRight:t(u)});return d("div",{key:l,ref:c(l),role:"radio",style:H,class:m("item"),tabindex:0,"aria-setsize":+n,"aria-posinset":x,"aria-checked":!z,onClick:e=>{v(),y(h?g(e.clientX):x)}},[d(i,{size:r,name:S?o:f,class:m("icon",{disabled:p,full:S}),color:p?w:S?s:b,classPrefix:j},null),C&&d(i,{size:r,style:{width:a.value+"em"},name:z?f:o,class:m("icon",["half",{disabled:p,full:!z}]),color:p?w:z?b:s,classPrefix:j},null)])};return f((()=>e.modelValue)),()=>d("div",{role:"radiogroup",class:m({readonly:e.readonly,disabled:e.disabled}),tabindex:0,onTouchstart:j,onTouchmove:w},[b.value.map(x)])}}));export{p as R};
