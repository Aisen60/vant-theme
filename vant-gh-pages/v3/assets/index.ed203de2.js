import{t as e,i as a}from"./use-translate.bf1abf23.js";import{c as t,r as l,w as n}from"./with-install.af140ae3.js";import{B as u,G as s,E as i,z as o,f as r,l as m,v as d,L as p,s as b}from"./vendor.09b5b9a9.js";import{p as c}from"./event.7d40caae.js";import{c as g}from"./interceptor.9b43abfe.js";import{a as v,g as f}from"./unit.36efb2dd.js";import{a as h,f as S}from"./number.b01aa591.js";import{u as y}from"./index.e6355079.js";const[w,N]=t("stepper");function x(e,a){return String(e)===String(a)}const V=n(u({name:w,props:{theme:String,integer:Boolean,disabled:Boolean,showPlus:e,showMinus:e,showInput:e,longPress:e,allowEmpty:Boolean,modelValue:[Number,String],inputWidth:[Number,String],buttonSize:[Number,String],placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,decimalLength:[Number,String],name:{type:[Number,String],default:""},min:{type:[Number,String],default:1},max:{type:[Number,String],default:1/0},step:{type:[Number,String],default:1},defaultValue:{type:[Number,String],default:1}},emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(e,{emit:t}){const n=t=>{const{min:l,max:n,allowEmpty:u,decimalLength:s}=e;return u&&""===t||(t=""===(t=S(String(t),!e.integer))?0:+t,t=Number.isNaN(t)?+l:t,t=Math.max(Math.min(+n,t),+l),a(s)&&(t=t.toFixed(+s))),t};let u;const w=s(),V=s((()=>{var a;const l=null!=(a=e.modelValue)?a:e.defaultValue,u=n(l);return x(u,e.modelValue)||t("update:modelValue",u),u})()),j=i((()=>e.disabled||e.disableMinus||V.value<=+e.min)),B=i((()=>e.disabled||e.disablePlus||V.value>=+e.max)),I=i((()=>({width:v(e.inputWidth),height:v(e.buttonSize)}))),M=i((()=>f(e.buttonSize))),P=a=>{e.beforeChange?g({args:[a],interceptor:e.beforeChange,done(){V.value=a}}):V.value=a},T=()=>{if("plus"===u&&B.value||"minus"===u&&j.value)return void t("overlimit",u);const a="minus"===u?-e.step:+e.step,l=n(h(+V.value,a));P(l),t(u)},C=t=>{const l=t.target,{value:n}=l,{decimalLength:u}=e;let s=S(String(n),!e.integer);if(a(u)&&s.includes(".")){const e=s.split(".");s=`${e[0]}.${e[1].slice(0,+u)}`}e.beforeChange?l.value=String(V.value):x(n,s)||(l.value=s);const i=s===String(+s);P(i?+s:s)},L=a=>{var l;e.disableInput?null==(l=w.value)||l.blur():t("focus",a)},z=e=>{const a=e.target,u=n(a.value);a.value=String(u),V.value=u,b((()=>{t("blur",e),l()}))};let E,F;const D=()=>{F=setTimeout((()=>{T(),D()}),200)},W=a=>{e.longPress&&(clearTimeout(F),E&&c(a))},$=a=>{e.disableInput&&a.preventDefault()},k=a=>({onClick:e=>{e.preventDefault(),u=a,T()},onTouchstart:()=>{u=a,e.longPress&&(E=!1,clearTimeout(F),F=setTimeout((()=>{E=!0,T(),D()}),600))},onTouchend:W,onTouchcancel:W});return o([()=>e.max,()=>e.min,()=>e.integer,()=>e.decimalLength],(()=>{const e=n(V.value);x(e,V.value)||(V.value=e)})),o((()=>e.modelValue),(e=>{x(e,V.value)||(V.value=n(e))})),o(V,(a=>{t("update:modelValue",a),t("change",a,{name:e.name})})),y((()=>e.modelValue)),()=>r("div",{class:N([e.theme])},[m(r("button",p({type:"button",style:M.value,class:N("minus",{disabled:j.value})},k("minus")),null),[[d,e.showMinus]]),m(r("input",{ref:w,type:e.integer?"tel":"text",role:"spinbutton",class:N("input"),value:V.value,style:I.value,disabled:e.disabled,readonly:e.disableInput,inputmode:e.integer?"numeric":"decimal",placeholder:e.placeholder,"aria-valuemax":+e.max,"aria-valuemin":+e.min,"aria-valuenow":+V.value,onBlur:z,onInput:C,onFocus:L,onMousedown:$},null),[[d,e.showInput]]),m(r("button",p({type:"button",style:M.value,class:N("plus",{disabled:B.value})},k("plus")),null),[[d,e.showPlus]])])}}));export{V as S};
