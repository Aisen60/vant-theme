var e=Object.defineProperty,o=Object.defineProperties,n=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,c=(o,n,t)=>n in o?e(o,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[n]=t,l=(e,o)=>{for(var n in o||(o={}))a.call(o,n)&&c(e,n,o[n]);if(t)for(var n of t(o))s.call(o,n)&&c(e,n,o[n]);return e},r=(e,t)=>o(e,n(t));import{t as i,i as u,q as d,a as p}from"./use-translate.bf1abf23.js";import{c as m,w as h}from"./with-install.af140ae3.js";import{C as b}from"./index.8591e547.js";import{B as g,f,E as v,H as x,z as y,I as j,l as C,v as w,s as B,G as D,r as S,c as k,w as O,D as T,o as $}from"./vendor.09b5b9a9.js";import{P}from"./index.02c1c9ae.js";import{u as I}from"./use-refs.b4c6d67f.js";import{T as A,a as E}from"./index.6702949b.js";import{F as L}from"./index.ce9148c1.js";import{B as F}from"./index.700b8aa4.js";import{C as M}from"./index.9143f396.js";import{u as N}from"./index.55079559.js";import{T as U}from"./function-call.2f25783d.js";import"./use-route.bc60204d.js";import"./index.5afcfd01.js";import"./unit.36efb2dd.js";import"./interceptor.9b43abfe.js";import"./use-expose.028ef04d.js";import"./use-touch.871001cd.js";import"./event.7d40caae.js";import"./index.2baefb73.js";import"./utils.fd06bcd3.js";import"./index.e4b17f1e.js";import"./use-lazy-render.bae5ade9.js";import"./on-popup-reopen.d2d6f1c6.js";import"./index.bb1b1d01.js";import"./useParent.60a302fe.js";import"./constant.4d85ecb9.js";import"./style.ae88e9b6.js";import"./index.35e19747.js";import"./index.18e77546.js";import"./useChildren.692bc2bf.js";import"./number.b01aa591.js";import"./index.e6355079.js";import"./index.4893bdc2.js";import"./Checker.90c07c2c.js";import"./mount-component.14353bf5.js";const[z,V,q]=m("coupon-cell");const _=h(g({name:z,props:{title:String,border:i,editable:i,coupons:{type:Array,default:()=>[]},currency:{type:String,default:"¥"},chosenCoupon:{type:[Number,String],default:-1}},setup:e=>()=>{const o=e.coupons[+e.chosenCoupon],n=function(e,o,n){const t=e[+o];if(t){let e=0;return u(t.value)?({value:e}=t):u(t.denominations)&&(e=t.denominations),`-${n} ${(e/100).toFixed(2)}`}return 0===e.length?q("noCoupon"):q("count",e.length)}(e.coupons,e.chosenCoupon,e.currency);return f(b,{class:V(),value:n,title:e.title||q("title"),border:e.border,isLink:e.editable,valueClass:V("value",{selected:o})},null)}})),[G,H,Y]=m("coupon");function J(e){const o=new Date(1e3*e);return`${o.getFullYear()}.${d(o.getMonth()+1)}.${d(o.getDate())}`}function K(e){return(e/100).toFixed(e%100==0?0:e%10==0?1:2)}const Q=h(g({name:G,props:{chosen:Boolean,disabled:Boolean,coupon:{type:Object,required:!0},currency:{type:String,default:"¥"}},setup(e){const o=v((()=>{const{startAt:o,endAt:n}=e.coupon;return`${J(o)} - ${J(n)}`})),n=v((()=>{const{coupon:o,currency:n}=e;if(o.valueDesc)return[o.valueDesc,f("span",null,[o.unitDesc||""])];if(o.denominations){const e=K(o.denominations);return[f("span",null,[n]),` ${e}`]}return o.discount?Y("discount",((t=o.discount)/10).toFixed(t%10==0?0:1)):"";var t})),t=v((()=>{const o=K(e.coupon.originCondition||0);return"0"===o?Y("unlimited"):Y("condition",o)}));return()=>{const{chosen:a,coupon:s,disabled:c}=e,l=c&&s.reason||s.description;return f("div",{class:H({disabled:c})},[f("div",{class:H("content")},[f("div",{class:H("head")},[f("h2",{class:H("amount")},[n.value]),f("p",{class:H("condition")},[s.condition||t.value])]),f("div",{class:H("body")},[f("p",{class:H("name")},[s.name]),f("p",{class:H("valid")},[o.value]),!c&&f(M,{class:H("corner"),modelValue:a},null)])]),l&&f("p",{class:H("description")},[l])])}}})),[R,W,X]=m("coupon-list");const Z=h(g({name:R,props:{showCount:i,enabledTitle:String,disabledTitle:String,showExchangeBar:i,showCloseButton:i,closeButtonText:String,inputPlaceholder:String,exchangeButtonText:String,exchangeButtonLoading:Boolean,exchangeButtonDisabled:Boolean,code:{type:String,default:""},exchangeMinLength:{type:Number,default:1},chosenCoupon:{type:Number,default:-1},coupons:{type:Array,default:()=>[]},disabledCoupons:{type:Array,default:()=>[]},displayedCouponIndex:{type:Number,default:-1},currency:{type:String,default:"¥"},emptyImage:{type:String,default:"https://img.yzcdn.cn/vant/coupon-empty.png"}},emits:["change","exchange","update:code"],setup(e,{emit:o,slots:n}){const[t,a]=I(),s=x({tab:0,code:e.code}),{height:c}=N(),l=v((()=>!e.exchangeButtonLoading&&(e.exchangeButtonDisabled||!s.code||s.code.length<e.exchangeMinLength))),r=v((()=>({height:c.value-(e.showExchangeBar?140:94)+"px"}))),i=()=>{o("exchange",s.code),e.code||(s.code="")},u=e=>{B((()=>{t.value[e]&&t.value[e].scrollIntoView()}))},d=()=>f("div",{class:W("empty")},[f("img",{src:e.emptyImage},null),f("p",null,[X("noCoupon")])]),p=()=>{if(e.showExchangeBar)return f("div",{class:W("exchange-bar")},[f(L,{modelValue:s.code,"onUpdate:modelValue":e=>s.code=e,clearable:!0,border:!1,class:W("field"),placeholder:e.inputPlaceholder||X("placeholder"),maxlength:"20"},null),f(F,{plain:!0,type:"danger",class:W("exchange"),text:e.exchangeButtonText||X("exchange"),loading:e.exchangeButtonLoading,disabled:l.value,onClick:i},null)])},m=()=>{const{coupons:t}=e,s=e.showCount?` (${t.length})`:"",c=(e.enabledTitle||X("enable"))+s;return f(E,{title:c},{default:()=>{var s;return[f("div",{class:W("list",{"with-bottom":e.showCloseButton}),style:r.value},[t.map(((n,t)=>f(Q,{key:n.id,ref:a(t),coupon:n,chosen:t===e.chosenCoupon,currency:e.currency,onClick:()=>o("change",t)},null))),!t.length&&d(),null==(s=n["list-footer"])?void 0:s.call(n)])]}})},h=()=>{const{disabledCoupons:o}=e,t=e.showCount?` (${o.length})`:"",a=(e.disabledTitle||X("disabled"))+t;return f(E,{title:a},{default:()=>{var t;return[f("div",{class:W("list",{"with-bottom":e.showCloseButton}),style:r.value},[o.map((o=>f(Q,{disabled:!0,key:o.id,coupon:o,currency:e.currency},null))),!o.length&&d(),null==(t=n["disabled-list-footer"])?void 0:t.call(n)])]}})};return y((()=>e.code),(e=>{s.code=e})),y((()=>s.code),(e=>o("update:code",e))),y((()=>e.displayedCouponIndex),u),j((()=>{u(e.displayedCouponIndex)})),()=>f("div",{class:W()},[p(),f(A,{active:s.tab,"onUpdate:active":e=>s.tab=e,class:W("tab"),border:!1},{default:()=>[m(),h()]}),f("div",{class:W("bottom")},[C(f(F,{round:!0,block:!0,type:"danger",class:W("close"),text:e.closeButtonText||X("close"),onClick:()=>o("change",-1)},null),[[w,e.showCloseButton]])])])}}));var ee=g({setup(e){const o=p({"zh-CN":{coupon:{name:"优惠券名称",reason:"优惠券不可用原因",description:"描述信息"},exchange:"兑换成功"},"en-US":{coupon:{name:"Coupon name",reason:"Coupon unavailable reason",description:"Description"},exchange:"Success"}}),n=(e=999999)=>String(Math.floor(Math.random()*e)+1),t=D(!1),a=D(-1),s=D([]),c=v((()=>({id:1,condition:"无使用门槛\n最多优惠12元",reason:"",value:150,name:o("coupon.name"),description:o("coupon.description"),startAt:1489104e3,endAt:1514592e3,valueDesc:"1.5",unitDesc:"元"}))),i=v((()=>r(l({},c.value),{id:2,value:12,valueDesc:"8.8",unitDesc:"折"}))),u=v((()=>r(l({},c.value),{id:3,reason:o("coupon.reason")}))),d=v((()=>r(l({},i.value),{valueDesc:"1",unitDesc:"折",id:4,reason:o("coupon.reason")}))),m=v((()=>[c.value,i.value,...s.value])),h=v((()=>[u.value,d.value])),b=e=>{t.value=!1,a.value=e},g=()=>{U(o("exchange")),s.value.push(r(l({},c.value),{id:n()}))};return(e,n)=>{const s=S("demo-block");return $(),k(s,{title:T(o)("basicUsage")},{default:O((()=>[f(T(_),{coupons:T(m),"chosen-coupon":a.value,onClick:n[0]||(n[0]=e=>t.value=!0)},null,8,["coupons","chosen-coupon"]),f(T(P),{show:t.value,"onUpdate:show":n[1]||(n[1]=e=>t.value=e),round:"",position:"bottom",style:{height:"90%","padding-top":"4px"}},{default:O((()=>[f(T(Z),{coupons:T(m),"chosen-coupon":a.value,"disabled-coupons":T(h),"show-count":!1,onChange:b,onExchange:g},null,8,["coupons","chosen-coupon","disabled-coupons"])])),_:1},8,["show"])])),_:1},8,["title"])}}});export{ee as default};
