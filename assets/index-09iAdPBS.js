import{d as $,o as p,b as w,f as y,aX as ue,u as de,aN as oe,a as K,i as G,r as h,e as S,w as O,g as u,t as x,h as F,_ as me,aY as Ce,aZ as ve,c as j,k as B,a2 as X,aS as Z,aW as fe,a_ as xe,aP as he,a$ as Ve,b0 as we,aO as U,aR as q,z as D,aT as Ee,aU as Ie,O as pe,A as _e}from"./main-QY2WlEIK.js";import{u as ne,c as Re,d as se,a as ke,V as ae,g as be,_ as Ne}from"./project-cFHKLKrF.js";import{x as Oe,y as je,o as $e,_ as M}from"./_plugin-vue_export-helper-615aeANG.js";import{P as v,a as H,s as Pe,i as Te,b as We,c as Ae,d as Q,e as Le,f as Me,h as Ue}from"./css-g76xnzBU.js";import{W as V}from"./WorkspaceEnum-XTYi_47x.js";import{I as R}from"./IframeSyncEnum-pf-6dmJO.js";const Be={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ze=y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M328 112L184 256l144 144"},null,-1),Fe=[ze],Ke=$({name:"ChevronBackOutline",render:function(o,e){return p(),w("svg",Be,Fe)}});let re=!1,ce=!1,ee=[],te=[];const le=n=>{re?n():ee.push(n)},ie=n=>{ce?n():te.push(n)},qe=()=>{re=!1},De=()=>{ce=!1},He=()=>{const n=o=>{o.data.type===R.IFRAME_READY&&(re=!0,ee.forEach(e=>e()),ee=[])};return window.addEventListener("message",n),n},Ge=()=>{const n=o=>{o.data.type===R.MOBILE_READY&&(ce=!0,te.forEach(e=>e()),te=[])};return window.addEventListener("message",n),n},Je=()=>{const n=o=>{var e,s;if(((e=o.data)==null?void 0:e.type)===R.REPLACE_PATH){const{id:t,version:_,component:c}=ue.currentRoute.value.params;let a=V.WORKSPACE_BASIC;(s=o.data)!=null&&s.value&&(a=o.data.value.split("/")[2]||V.WORKSPACE_BASIC),c!==a&&ue.replace({name:"workspace",params:{id:t,version:_,component:a}}).catch(()=>{})}};return window.addEventListener("message",n),n},Ye=n=>{const o=e=>{var s;if(((s=e.data)==null?void 0:s.type)===R.GET_VAR){const t=JSON.parse(e.data.value);n(t)}};return window.addEventListener("message",o),o},Qe=(n,o)=>{const e=document.querySelector("iframe");e&&le(()=>{var s;(s=e.contentWindow)==null||s.postMessage({type:R.UPDATE_LOCALE,value:JSON.stringify({appLocale:n,project:o})},"*")})},Se=n=>{const o=document.querySelector("iframe");o&&le(()=>{var e;(e=o.contentWindow)==null||e.postMessage({type:R.UPDATE_THEME,value:n},"*")})},ye=n=>{const o=document.querySelector("iframe");o&&le(()=>{var e;(e=o.contentWindow)==null||e.postMessage({type:R.REPLACE_PATH,value:n},"*")})},Xe=n=>{const o=document.querySelector("iframe");o&&ie(()=>{var e;(e=o.contentWindow)==null||e.postMessage({type:R.GET_VAR,value:JSON.stringify(n)},"*")})},Ze=n=>{const o=document.querySelector("iframe");o&&ie(()=>{var e;(e=o.contentWindow)==null||e.postMessage({type:R.SET_VAR,value:JSON.stringify(n)},"*")})},et=n=>{const o=document.querySelector("iframe");o&&ie(()=>{var e;(e=o.contentWindow)==null||e.postMessage({type:R.SET_VAR_V2,value:n},"*")})},tt={class:"flex justify-between workspace-header"},ot={class:"flex items-center workspace-header-title"},nt={class:"workspace-header-title-name"},st={class:"flex items-center workspace-header-operation"},at=$({name:"WorkspaceHeader",__name:"Header",emits:["resetProjectFn"],setup(n,{emit:o}){const e=o,s=de(),t=ne(),_=Re(),{t:c}=oe(),a=K(),d=se(),m=G("project"),l=h(!1),r=()=>{s.push("/project")},E=()=>{Qe(a.locale,m.value)},k=()=>{if(a.theme==="dark"&&m.value.version!==v.VERSION_4){t.warning(c("workspace_switch_theme_tip"));return}Se(a.theme)},b=()=>{l.value=!0,d.exportProject(m.value).then(()=>{t.success(c("success_export"))}).catch(()=>{}).finally(()=>{l.value=!1})},P=()=>{_.error({title:c("reset_tips"),showIcon:!1,content:c("confirm_reset"),positiveText:c("confirm_text"),negativeText:c("cancel_text"),maskClosable:!1,onPositiveClick:()=>{d.resetProject(m.value),t.success(c("success_reset")),e("resetProjectFn")},onNegativeClick:()=>{}})};return(g,T)=>{var N;const W=$e,A=me;return p(),w("div",tt,[y("div",ot,[S(A,{quaternary:"",focusable:!1,style:{"--n-height":"30px","--n-padding":"0 6px","--n-color-hover":"var(--vt-color-fill-3)"},onClick:r},{icon:O(()=>[S(W,{color:"var(--vt-color-text-1)",size:"var(--vt-font-size-5)",class:"cursor-pointer"},{default:O(()=>[S(u(Ke))]),_:1})]),_:1}),y("h1",nt,x((N=u(m))==null?void 0:N.name),1)]),y("div",st,[S(Oe,{type:"button",onSwitch:E}),S(je,{type:"button",onSwitch:k}),S(A,{type:"primary",loading:u(l),onClick:b},{default:O(()=>[F(x(g.$t("export_project")),1)]),_:1},8,["loading"]),S(A,{type:"error",onClick:P},{default:O(()=>[F(x(g.$t("reset_project")),1)]),_:1})])])}}}),rt=M(at,[["__scopeId","data-v-8dae4282"]]),J=Ce("workspaceStore",()=>{const n=h(V.WORKSPACE_BASIC);return{component:n,setComponent:s=>{n.value=s},initBaseMenu:async()=>H(V.WORKSPACE_MENU)?H(V.WORKSPACE_MENU):await Promise.all([fetch(`/vant-theme/vant/${v.VERSION_2}/menu/zh-CN.json`),fetch(`/vant-theme/vant/${v.VERSION_2}/menu/en-US.json`),fetch(`/vant-theme/vant/${v.VERSION_3}/menu/zh-CN.json`),fetch(`/vant-theme/vant/${v.VERSION_3}/menu/en-US.json`),fetch(`/vant-theme/vant/${v.VERSION_4}/menu/zh-CN.json`),fetch(`/vant-theme/vant/${v.VERSION_4}/menu/en-US.json`)]).then(async s=>{const t={[v.VERSION_2]:{"zh-CN":[],"en-US":[]},[v.VERSION_3]:{"zh-CN":[],"en-US":[]},[v.VERSION_4]:{"zh-CN":[],"en-US":[]}};return t.v2["zh-CN"]=await s[0].json(),t.v2["en-US"]=await s[1].json(),t.v3["zh-CN"]=await s[2].json(),t.v3["en-US"]=await s[3].json(),t.v4["zh-CN"]=await s[4].json(),t.v4["en-US"]=await s[5].json(),Pe(V.WORKSPACE_MENU,t),t})}}),ct={class:"overflow-y-auto workspace-nav"},lt={class:"workspace-nav-group-title"},it=["onClick","data-nav-id"],ut=$({name:"WorkspaceNav",__name:"Nav",setup(n,{expose:o}){const e=ve(),s=K(),t=J(),_=G("project"),c=j(()=>t.component),a=j(()=>H(V.WORKSPACE_MENU)[_.value.version][s.locale]),d=l=>{let r="/"+s.locale;l!==V.WORKSPACE_BASIC&&(r+="/"+l),ye(r)},m=()=>{const l=document.querySelector(`[data-nav-id=${c.value}]`);l&&l.scrollIntoView({block:"center"})};return B(()=>e.params,l=>{t.setComponent(l.component),m()},{deep:!0,immediate:!0}),o({onScrollToComponent:m}),(l,r)=>(p(),w("div",ct,[(p(!0),w(X,null,Z(u(a),E=>(p(),w("ul",{key:E.value,class:"workspace-nav-group"},[y("div",lt,x(E.label),1),(p(!0),w(X,null,Z(E.children,k=>(p(),w("li",{key:k.value,class:fe(["workspace-nav-group-item",{active:u(c)===k.value}]),onClick:b=>d(k.value),"data-nav-id":k.value},x(k.label),11,it))),128))]))),128))]))}}),pt=M(ut,[["__scopeId","data-v-b923a121"]]),_t="/vant-theme/assets/no-css-var-oW3TOdfw.png",dt={class:"workspace-color-item"},mt={class:"item-label"},vt=$({name:"WorkspaceColorItem",__name:"ColorItem",props:{label:{},defaultValue:{},isVar:{type:Boolean},varLabel:{}},emits:["change"],setup(n,{emit:o}){xe(d=>({"1feaff5c":e.defaultValue}));const e=n,s=o,t=h(""),_=j(()=>Te(e.defaultValue)),c=j(()=>We(e.defaultValue)),a=d=>{s("change",e.label,d)};return B(()=>e.defaultValue,()=>{t.value=e.isVar?e.varLabel:e.defaultValue},{immediate:!0}),(d,m)=>{const l=ke;return p(),w("div",dt,[y("p",mt,x(e.label),1),S(l,{value:u(t),"onUpdate:value":m[0]||(m[0]=r=>he(t)?t.value=r:null),type:"text",clearable:"",onChange:a},{prefix:O(()=>[y("div",{class:fe(["item-color-prefix",{"is-white":u(_),"is-transparent":u(c)}])},null,2)]),_:1},8,["value"])])}}}),ft=M(vt,[["__scopeId","data-v-96a4eb67"]]),ht={class:"workspace-input-item"},wt={class:"item-label"},kt=$({name:"WorkspaceInputItem",__name:"InputItem",props:{label:{},defaultValue:{},isVar:{type:Boolean},varLabel:{}},emits:["change"],setup(n,{emit:o}){const e=n,s=o,t=h(""),_=c=>{s("change",e.label,c)};return B(()=>e.defaultValue,()=>{t.value=e.defaultValue},{immediate:!0}),(c,a)=>{const d=ke;return p(),w("div",ht,[y("p",wt,x(e.label),1),S(d,{value:u(t),"onUpdate:value":a[0]||(a[0]=m=>he(t)?t.value=m:null),type:"text",clearable:"",onChange:_},null,8,["value"])])}}}),St=M(kt,[["__scopeId","data-v-91d7cc78"]]),yt=(n,o)=>{const e=Ve(),t=H(V.WORKSPACE_MENU)[n.version][e.locale];for(let _=0;_<t.length;_++){const c=t[_].children.find(a=>a.value===o);if(c)return c.label}},gt=n=>(Ee("data-v-0638ff30"),n=n(),Ie(),n),Ct={class:"flex flex-col flex-1 workspace-work"},xt={class:"flex items-center justify-between workspace-work-header"},Vt={class:"flex-1 overflow-y-auto workspace-work-container"},Et={key:1,class:"workspace-work-wrapper"},It={key:1,class:"flex items-center justify-center flex-col workspace-no-css-var"},Rt=gt(()=>y("img",{class:"w-[300px]",src:_t,draggable:"false"},null,-1)),bt={class:"text-lg text-[var(--vt-color-text-2)]"},Nt=$({name:"WorkspaceWork",__name:"Work",setup(n,{expose:o}){const e=ne(),{t:s}=oe(),t=K(),_=se(),c=J(),a=G("project"),d=j(()=>c.component),m=h(!1),l=h(s("workspace_loading_component_var"));let r=null;const E=h(""),k=h(),b=h(!1),P=()=>{const i=yt(a.value,d.value);E.value=i||""},g=()=>{const C=Ae(a.value.version)[d.value],I=Q(a.value.id,a.value.version===v.VERSION_4?t.theme:"light"),L={};for(const[f]of Object.entries(C)){const z=I[f]||C[f];L[f]=z}Xe(L)},T=()=>{const i=Me()[a.value.id];Ze(i)},W=(i,C)=>{const I={...a.value};I.updateTime=String(be()),_.updateProject(I);const L=Q(I.id,a.value.version===v.VERSION_4?t.theme:"light");Le(I.id,a.value.version===v.VERSION_4?t.theme:"light",{...L,[i]:C}),T(),g()},A=()=>{T(),g(),a.value.version===v.VERSION_2&&N()},N=()=>{r=e.create(s("workspace_build_component_var_loading"),{type:"loading",duration:0});const i=Q(a.value.id,"light"),C=new Headers;C.append("Content-Type","application/json");const I=JSON.stringify(i);b.value=!0,fetch("https://vant-theme-service.vercel.app/api/update-theme",{method:"POST",headers:C,body:I,redirect:"follow"}).then(async f=>f.text()).then(f=>{r&&(r.type="success",r.content=s("workspace_build_component_var_success"),setTimeout(()=>{r==null||r.destroy(),r=null},1e3)),et(f)}).catch(f=>(r&&(r.type="error",r.content=s("workspace_build_component_var_failed"),setTimeout(()=>{r==null||r.destroy(),r=null},3e3)),Promise.reject(f))).finally(()=>{b.value=!1})},Y=Ye(i=>{const C=Ue(i);k.value=C,m.value=!1});return(()=>{D(()=>{T(),a.value.version===v.VERSION_2&&N()})})(),B(()=>t.locale,()=>{P();let i="/"+t.locale;d.value!==V.WORKSPACE_BASIC&&(i+="/"+d.value),ye(i)}),B(()=>t.theme,()=>{D(()=>{g()})}),B(()=>d.value,()=>{P(),D(()=>{g()})},{immediate:!0}),we(()=>{window.removeEventListener("message",Y)}),o({onSetCompLabel:P,onSetCompVar:g,onResetProjectFn:A}),(i,C)=>{const I=me,L=Ne;return p(),w("div",Ct,[y("div",xt,[F(x(u(E))+" ",1),u(a).version===u(v).VERSION_2?(p(),U(L,{key:0},{trigger:O(()=>[S(I,{type:"info",loading:u(b),onClick:N},{default:O(()=>[F(x(u(s)("workspace_build_component_var")),1)]),_:1},8,["loading"])]),default:O(()=>[F(" "+x(u(s)("workspace_build_component_var_tip")),1)]),_:1})):q("",!0)]),y("div",Vt,[u(m)?(p(),U(ae,{key:0,class:"w-full pt-5 pl-5 pr-5 mx-auto max-w-7xl",text:u(l)},null,8,["text"])):(p(),w("div",Et,[u(k)&&Object.keys(u(k)).length?(p(!0),w(X,{key:0},Z(u(k),(f,z)=>(p(),w("div",{class:"class=item-component",key:z},[f.type==="0"?(p(),U(St,{key:0,label:z,"default-value":f.value,"is-var":f.isVar,"var-label":f.varLabel,onChange:W},null,8,["label","default-value","is-var","var-label"])):q("",!0),f.type==="1"?(p(),U(ft,{key:1,label:z,"default-value":f.value,"is-var":f.isVar,"var-label":f.varLabel,onChange:W},null,8,["label","default-value","is-var","var-label"])):q("",!0)]))),128)):(p(),w("div",It,[Rt,y("p",bt,x(i.$t("workspace_component_no_var")),1)]))]))])])}}}),Ot=M(Nt,[["__scopeId","data-v-0638ff30"]]),jt={class:"relative flex items-center workspace-preview"},$t=["src"],Pt=$({name:"WorkspacePreview",__name:"Preview",setup(n){const o=K(),e=J(),s=G("project"),t=j(()=>e.component),_=h(!0),c=h(""),a=()=>{let l=`/vant-theme/mobile/${s.value.version}.html#/${o.locale}`;t.value!==V.WORKSPACE_BASIC&&(l+="/"+t.value),c.value=l},d=()=>{_.value=!1};return(()=>{a()})(),(l,r)=>(p(),w("div",jt,[u(_)?(p(),U(ae,{key:0,class:"absolute z-10 workspace-preview-skeleton",rows:20})):q("",!0),y("iframe",{class:"workspace-preview-mobile",src:u(c),onLoad:d},null,40,$t)]))}}),Tt=M(Pt,[["__scopeId","data-v-31ef0eaf"]]),Wt={class:"flex flex-col workspace"},At={key:1,class:"flex flex-1 overflow-hidden workspace-content"},Lt=$({name:"Workspace",__name:"index",setup(n){const o=ve(),e=de(),s=ne(),{t}=oe(),_=K(),c=se(),a=J(),d=h(!1),m=h(!1),l=h(t("load_vant_menu_failed")),r=j(()=>c.allProject.find(i=>i.id===o.params.id));pe("project",r);const E=j(()=>a.component);pe("component",E);const k=h(null),b=h(null),P=h(null);let g,T,W;const A=()=>{var i;(i=b.value)==null||i.onResetProjectFn()},N=async()=>{try{m.value=!0,await a.initBaseMenu(),m.value=!1}catch{const i=_e("div",{class:"flex"},[_e("span",{},t("load_vant_css_failed")+t("period"))]);return l.value=i,s.create(()=>i,{type:"error",keepAliveOnHover:!0,duration:0,closable:!0}),Promise.reject(t("load_vant_css_failed")+t("period"))}},Y=()=>{if(_.theme==="dark"&&r.value.version!==v.VERSION_4){s.warning(t("workspace_switch_theme_tip"));return}Se(_.theme)};return(async()=>{if(o.params.version!==v.VERSION_2&&o.params.version!==v.VERSION_3&&o.params.version!==v.VERSION_4){s.error(t("project_info_error"),{onAfterLeave:()=>{e.replace("/project")}});return}if(!r.value){s.error(t("project_not_exist"),{onAfterLeave:()=>{e.replace("/project")}});return}await N(),d.value=!0,qe(),De(),g=He(),T=Ge(),W=Je(),D(()=>{_.theme==="dark"&&Y()})})(),we(()=>{window.removeEventListener("message",g),window.removeEventListener("message",T),window.removeEventListener("message",W)}),(i,C)=>(p(),w("div",Wt,[S(rt,{onResetProjectFn:A}),u(m)?(p(),U(ae,{key:0,class:"w-full pt-20 pl-5 pr-5 mx-auto max-w-7xl workspace-skeleton",text:u(l)},null,8,["text"])):(p(),w("div",At,[S(pt,{ref_key:"workspaceNavRef",ref:k},null,512),S(Tt,{ref_key:"workspacePreviewRef",ref:P},null,512),S(Ot,{ref_key:"workspaceWorkRef",ref:b},null,512)]))]))}}),qt=M(Lt,[["__scopeId","data-v-b623e435"]]);export{qt as default};
